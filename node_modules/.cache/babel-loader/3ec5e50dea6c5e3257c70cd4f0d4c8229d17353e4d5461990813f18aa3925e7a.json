{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Vladislav\\\\Documents\\\\GitHub\\\\aist-messenger\\\\src\\\\pages\\\\Register.jsx\",\n  _window$location,\n  _s = $RefreshSig$();\nimport React, { useEffect, useMemo, useRef, useState } from \"react\";\nimport { Link, useSearchParams } from \"react-router-dom\";\nimport { QRCodeSVG } from \"qrcode.react\";\nimport { useTheme } from \"../context/ThemeContext\";\n\n/**\r\n * AIST PWA Messenger — Register/Login screen\r\n * Вход по коду из Telegram или (в будущем) по СМС. При входе по коду из ТГ — пользовательское соглашение (законы РФ).\r\n */\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst API_BASE_URL = process.env.REACT_APP_API_URL || (typeof window !== \"undefined\" && ((_window$location = window.location) === null || _window$location === void 0 ? void 0 : _window$location.hostname) === \"localhost\" ? \"http://localhost:3001\" : \"https://api.get-aist.ru\");\nconst USER_AGREEMENT_URL = \"/user-agreement\";\nfunction normalizePhone(input) {\n  if (!input) return \"\";\n  const digitsOnly = String(input).replace(/\\D/g, \"\");\n  if (digitsOnly.length === 11 && digitsOnly.startsWith(\"7\")) {\n    return \"+\" + digitsOnly;\n  } else if (digitsOnly.length === 10) {\n    return \"+7\" + digitsOnly;\n  } else if (digitsOnly.length === 11 && digitsOnly.startsWith(\"8\")) {\n    return \"+7\" + digitsOnly.substring(1);\n  }\n  return \"\";\n}\nfunction isValidPhone(value) {\n  const normalized = normalizePhone(value);\n  if (!normalized) return false;\n  return /^\\+7\\d{10}$/.test(normalized);\n}\nfunction formatPhone(value) {\n  const normalized = normalizePhone(value);\n  if (!normalized) return value;\n  return normalized.replace(/^(\\+7)(\\d{3})(\\d{3})(\\d{2})(\\d{2})$/, \"$1 ($2) $3-$4-$5\");\n}\nfunction digitsOnly(value) {\n  return String(value !== null && value !== void 0 ? value : \"\").replace(/\\D+/g, \"\");\n}\nasync function postJson(url, body, {\n  signal\n} = {}) {\n  var _json;\n  let res;\n  try {\n    // Добавляем таймаут 30 секунд\n    const controller = new AbortController();\n    const timeoutId = setTimeout(() => controller.abort(), 30000);\n    if (signal) {\n      signal.addEventListener('abort', () => {\n        clearTimeout(timeoutId);\n      });\n    }\n    res = await fetch(url, {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify(body !== null && body !== void 0 ? body : {}),\n      signal: signal || controller.signal\n    });\n    clearTimeout(timeoutId);\n  } catch (e) {\n    if (e.name === \"AbortError\") throw e;\n    const msg = e.message || \"\";\n    if (msg.includes(\"Failed to fetch\") || msg.includes(\"Load failed\") || msg.includes(\"NetworkError\")) {\n      throw new Error(\"Нет связи с сервером. Проверьте интернет и что бэкенд запущен (например http://localhost:3001). В .env задайте REACT_APP_API_URL.\");\n    }\n    throw new Error(msg || \"Ошибка сети\");\n  }\n  let json = null;\n  try {\n    json = await res.json();\n  } catch {\n    // ignore\n  }\n  if (!res.ok) {\n    const message = json && (json.message || json.error) || `HTTP ${res.status} ${res.statusText}`.trim();\n    const err = new Error(message);\n    err.status = res.status;\n    err.payload = json;\n    throw err;\n  }\n  return (_json = json) !== null && _json !== void 0 ? _json : {};\n}\nexport default function Register() {\n  _s();\n  const {\n    theme,\n    isDark\n  } = useTheme();\n  const [authMethod, setAuthMethod] = useState(\"telegram\"); // 'telegram' | 'sms' (sms пока заглушка)\n  const [step, setStep] = useState(\"request\");\n  const [phoneInput, setPhoneInput] = useState(\"\");\n  const [phone, setPhone] = useState(\"\");\n  const [code, setCode] = useState(\"\");\n  const [agreementAccepted, setAgreementAccepted] = useState(false);\n  const [busy, setBusy] = useState(false);\n  const [message, setMessage] = useState(\"\");\n  const [maskedDestination, setMaskedDestination] = useState(\"\");\n  const [ttlSeconds, setTtlSeconds] = useState(null);\n  const [remaining, setRemaining] = useState(null);\n  const [cooldown, setCooldown] = useState(0);\n  const [debugCode, setDebugCode] = useState(\"\");\n  const [searchParams, setSearchParams] = useSearchParams();\n  const confirmQrCode = searchParams.get(\"confirm-qr\") || \"\";\n  const [qrCode, setQrCode] = useState(\"\");\n  const [qrStatus, setQrStatus] = useState(\"\");\n  const [qrConfirming, setQrConfirming] = useState(false);\n  const [qrConfirmed, setQrConfirmed] = useState(false);\n  const token = typeof window !== \"undefined\" ? localStorage.getItem(\"aist_token\") : null;\n  const abortRef = useRef(null);\n  const codeInputRef = useRef(null);\n  const qrPollRef = useRef(null);\n  const canRequest = useMemo(() => {\n    if (busy) return false;\n    if (cooldown > 0) return false;\n    return isValidPhone(phoneInput);\n  }, [busy, cooldown, phoneInput]);\n  const canVerify = useMemo(() => {\n    if (busy) return false;\n    if (!agreementAccepted) return false;\n    const d = digitsOnly(code);\n    return d.length >= 4 && d.length <= 8;\n  }, [busy, agreementAccepted, code]);\n  useEffect(() => {\n    return () => {\n      if (abortRef.current) abortRef.current.abort();\n    };\n  }, []);\n  useEffect(() => {\n    if (remaining == null) return;\n    if (remaining <= 0) return;\n    const t = setInterval(() => setRemaining(r => r == null ? r : r - 1), 1000);\n    return () => clearInterval(t);\n  }, [remaining]);\n  useEffect(() => {\n    if (cooldown <= 0) return;\n    const t = setInterval(() => setCooldown(c => c <= 0 ? 0 : c - 1), 1000);\n    return () => clearInterval(t);\n  }, [cooldown]);\n  useEffect(() => {\n    if (step !== \"verify\") return;\n    const t = setTimeout(() => {\n      var _codeInputRef$current, _codeInputRef$current2;\n      return (_codeInputRef$current = codeInputRef.current) === null || _codeInputRef$current === void 0 ? void 0 : (_codeInputRef$current2 = _codeInputRef$current.focus) === null || _codeInputRef$current2 === void 0 ? void 0 : _codeInputRef$current2.call(_codeInputRef$current);\n    }, 50);\n    return () => clearTimeout(t);\n  }, [step]);\n\n  // QR: запрос кода при открытии вкладки «По QR» (на ПК)\n  useEffect(() => {\n    if (authMethod !== \"qr\" || confirmQrCode) return;\n    let cancelled = false;\n    (async () => {\n      try {\n        const res = await fetch(`${API_BASE_URL}/api/auth/qr/request`, {\n          method: \"POST\"\n        });\n        const data = await res.json();\n        if (cancelled || !(data !== null && data !== void 0 && data.code)) return;\n        setQrCode(data.code);\n        setQrStatus(\"pending\");\n      } catch {\n        setQrStatus(\"error\");\n      }\n    })();\n    return () => {\n      cancelled = true;\n    };\n  }, [authMethod, confirmQrCode]);\n\n  // QR: опрос готовности (на ПК)\n  useEffect(() => {\n    if (!qrCode || qrStatus !== \"pending\") return;\n    const poll = async () => {\n      try {\n        const res = await fetch(`${API_BASE_URL}/api/auth/qr/check?code=${encodeURIComponent(qrCode)}`);\n        const data = await res.json();\n        if ((data === null || data === void 0 ? void 0 : data.status) === \"ready\" && data !== null && data !== void 0 && data.token) {\n          localStorage.setItem(\"aist_token\", data.token);\n          window.location.assign(\"/messenger\");\n          return;\n        }\n        if ((data === null || data === void 0 ? void 0 : data.status) === \"expired\") setQrStatus(\"expired\");\n      } catch {}\n    };\n    poll();\n    const id = setInterval(poll, 2000);\n    qrPollRef.current = id;\n    return () => clearInterval(id);\n  }, [qrCode, qrStatus]);\n\n  // Сброс опроса при смене вкладки\n  useEffect(() => {\n    if (authMethod !== \"qr\") {\n      if (qrPollRef.current) clearInterval(qrPollRef.current);\n    }\n  }, [authMethod]);\n  async function requestCode() {\n    var _abortRef$current, _abortRef$current$abo;\n    setMessage(\"\");\n    const normalized = normalizePhone(phoneInput);\n    if (!isValidPhone(normalized)) {\n      setMessage(\"Введите корректный номер телефона (например, +7 999 123-45-67 или 8 999 123-45-67).\");\n      return;\n    }\n    setBusy(true);\n    (_abortRef$current = abortRef.current) === null || _abortRef$current === void 0 ? void 0 : (_abortRef$current$abo = _abortRef$current.abort) === null || _abortRef$current$abo === void 0 ? void 0 : _abortRef$current$abo.call(_abortRef$current);\n    const controller = new AbortController();\n    abortRef.current = controller;\n    try {\n      const data = await postJson(`${API_BASE_URL}/api/auth/request-code`, {\n        phone: normalized\n      }, {\n        signal: controller.signal\n      });\n      if ((data === null || data === void 0 ? void 0 : data.ok) === false) {\n        const errorMsg = (data === null || data === void 0 ? void 0 : data.message) || \"Не удалось отправить код. Попробуйте ещё раз.\";\n        setMessage(errorMsg);\n        if (errorMsg.includes(\"не найден\") || errorMsg.includes(\"активируйте\")) {\n          setMessage(errorMsg + \" После активации попробуйте снова.\");\n        }\n        return;\n      }\n      setPhone(normalized);\n      setMaskedDestination((data === null || data === void 0 ? void 0 : data.masked) || \"\");\n      setTtlSeconds(typeof (data === null || data === void 0 ? void 0 : data.ttlSeconds) === \"number\" ? data.ttlSeconds : 300);\n      setRemaining(typeof (data === null || data === void 0 ? void 0 : data.ttlSeconds) === \"number\" ? data.ttlSeconds : 300);\n      setCooldown(15);\n      const devCode = (data === null || data === void 0 ? void 0 : data.debugCode) != null ? String(data.debugCode) : \"\";\n      setDebugCode(devCode);\n      setCode(devCode);\n      setAgreementAccepted(false);\n      setStep(\"verify\");\n      if (devCode) {\n        setMessage(\"Код для входа (режим разработки): введите его ниже или скопируйте.\");\n      } else {\n        setMessage(data !== null && data !== void 0 && data.masked ? `Код отправлен в Telegram на номер ${data.masked}.` : \"Код отправлен в Telegram-бот @AIST_SMS_BOT. Введите его здесь.\");\n      }\n    } catch (err) {\n      if ((err === null || err === void 0 ? void 0 : err.name) === \"AbortError\") return;\n      setMessage((err === null || err === void 0 ? void 0 : err.message) || \"Ошибка сети при отправке кода. Проверьте REACT_APP_API_URL и что бэкенд запущен.\");\n    } finally {\n      setBusy(false);\n    }\n  }\n  async function verifyCode() {\n    var _abortRef$current2, _abortRef$current2$ab;\n    setMessage(\"\");\n    const normalizedPhone = normalizePhone(phone);\n    const d = digitsOnly(code);\n    if (!normalizedPhone) {\n      setStep(\"request\");\n      setMessage(\"Сначала укажите номер телефона и запросите код.\");\n      return;\n    }\n    if (d.length < 4 || d.length > 8) {\n      setMessage(\"Введите код из 4–8 цифр.\");\n      return;\n    }\n    if (!agreementAccepted) {\n      setMessage(\"Необходимо принять пользовательское соглашение.\");\n      return;\n    }\n    setBusy(true);\n    (_abortRef$current2 = abortRef.current) === null || _abortRef$current2 === void 0 ? void 0 : (_abortRef$current2$ab = _abortRef$current2.abort) === null || _abortRef$current2$ab === void 0 ? void 0 : _abortRef$current2$ab.call(_abortRef$current2);\n    const controller = new AbortController();\n    abortRef.current = controller;\n    try {\n      const data = await postJson(`${API_BASE_URL}/api/auth/verify-code`, {\n        phone: normalizedPhone,\n        code: d\n      }, {\n        signal: controller.signal\n      });\n      if ((data === null || data === void 0 ? void 0 : data.ok) === false) {\n        const errorMsg = (data === null || data === void 0 ? void 0 : data.message) || \"Неверный код или он истёк. Попробуйте ещё раз.\";\n        if (typeof (data === null || data === void 0 ? void 0 : data.retryAfterSeconds) === \"number\") {\n          const retrySec = Math.max(0, Math.floor(data.retryAfterSeconds));\n          setCooldown(retrySec);\n          setMessage(`${errorMsg} Повторить можно через ${retrySec} секунд.`);\n        } else {\n          setMessage(errorMsg);\n        }\n        return;\n      }\n      const token = data === null || data === void 0 ? void 0 : data.token;\n      if (token) {\n        localStorage.setItem(\"aist_token\", token);\n      }\n      window.location.assign(\"/messenger\");\n    } catch (err) {\n      if ((err === null || err === void 0 ? void 0 : err.name) === \"AbortError\") return;\n      setMessage((err === null || err === void 0 ? void 0 : err.message) || \"Ошибка сети при проверке кода.\");\n    } finally {\n      setBusy(false);\n    }\n  }\n  function onCodeChange(e) {\n    const next = digitsOnly(e.target.value).slice(0, 8);\n    setCode(next);\n  }\n  const glassStyle = useMemo(() => ({\n    page: {\n      minHeight: \"100vh\",\n      width: \"100vw\",\n      display: \"grid\",\n      placeItems: \"center\",\n      padding: \"20px 0\",\n      margin: 0,\n      color: theme.text,\n      background: theme.pageBg,\n      backgroundAttachment: \"fixed\",\n      overflow: \"auto\"\n    },\n    card: {\n      width: \"min(460px, 92vw)\",\n      borderRadius: 22,\n      padding: 22,\n      background: theme.cardBg,\n      border: `1px solid ${theme.cardBorder}`,\n      boxShadow: isDark ? \"0 18px 60px rgba(0,0,0,.4), inset 0 1px 0 rgba(255,255,255,.08)\" : \"0 20px 60px rgba(80,120,180,.18), inset 0 1px 0 rgba(255,255,255,.7)\",\n      backdropFilter: \"blur(16px) saturate(140%)\",\n      WebkitBackdropFilter: \"blur(16px) saturate(140%)\",\n      position: \"relative\",\n      overflow: \"hidden\"\n    },\n    shine: {\n      position: \"absolute\",\n      inset: \"-2px\",\n      background: isDark ? \"radial-gradient(500px 240px at 20% 10%, rgba(255,255,255,.12), transparent 60%)\" : \"radial-gradient(400px 200px at 80% 0%, rgba(255,255,255,.4), transparent 55%)\",\n      pointerEvents: \"none\",\n      mixBlendMode: \"overlay\"\n    },\n    header: {\n      display: \"flex\",\n      gap: 12,\n      alignItems: \"center\"\n    },\n    logo: {\n      width: 44,\n      height: 44,\n      borderRadius: 14,\n      background: theme.accent,\n      border: \"1px solid rgba(255,255,255,.35)\",\n      boxShadow: \"0 8px 24px rgba(0,0,0,.2)\",\n      display: \"grid\",\n      placeItems: \"center\",\n      fontWeight: 800,\n      fontSize: 16,\n      color: theme.accentText,\n      userSelect: \"none\"\n    },\n    titleWrap: {\n      display: \"flex\",\n      flexDirection: \"column\"\n    },\n    title: {\n      margin: 0,\n      fontSize: 18,\n      fontWeight: 700,\n      lineHeight: 1.15,\n      color: theme.text\n    },\n    subtitle: {\n      margin: \"6px 0 0\",\n      fontSize: 13,\n      color: theme.textMuted,\n      lineHeight: 1.25\n    },\n    tabs: {\n      display: \"flex\",\n      gap: 8,\n      marginBottom: 16,\n      borderBottom: `1px solid ${theme.border}`,\n      paddingBottom: 12\n    },\n    tab: {\n      padding: \"8px 14px\",\n      borderRadius: 12,\n      border: \"none\",\n      background: \"transparent\",\n      color: theme.textMuted,\n      fontSize: 14,\n      cursor: \"pointer\"\n    },\n    tabActive: {\n      color: theme.text,\n      background: theme.sidebarBg || theme.cardBg,\n      fontWeight: 600\n    },\n    tabDisabled: {\n      opacity: 0.5,\n      cursor: \"not-allowed\"\n    },\n    divider: {\n      height: 1,\n      background: `linear-gradient(90deg, transparent, ${theme.border}, transparent)`,\n      margin: \"16px 0\"\n    },\n    field: {\n      display: \"grid\",\n      gap: 8,\n      marginTop: 12\n    },\n    label: {\n      fontSize: 12,\n      color: theme.textMuted,\n      display: \"flex\",\n      justifyContent: \"space-between\",\n      gap: 12\n    },\n    helper: {\n      fontSize: 12,\n      color: theme.textMuted,\n      opacity: 0.9\n    },\n    input: {\n      width: \"100%\",\n      padding: \"12px 14px\",\n      borderRadius: 14,\n      outline: \"none\",\n      color: theme.text,\n      background: theme.inputBg,\n      border: `1px solid ${theme.inputBorder}`,\n      fontSize: 14\n    },\n    inputRow: {\n      display: \"grid\",\n      gridTemplateColumns: \"1fr\",\n      gap: 10\n    },\n    buttonsRow: {\n      display: \"flex\",\n      gap: 10,\n      marginTop: 14,\n      flexWrap: \"wrap\"\n    },\n    primaryBtn: {\n      flex: \"1 1 160px\",\n      padding: \"12px 14px\",\n      borderRadius: 14,\n      border: \"1px solid rgba(255,255,255,.25)\",\n      color: theme.accentText,\n      background: theme.accent,\n      boxShadow: \"0 10px 30px rgba(0,0,0,.2)\",\n      fontWeight: 600,\n      cursor: \"pointer\"\n    },\n    secondaryBtn: {\n      flex: \"1 1 160px\",\n      padding: \"12px 14px\",\n      borderRadius: 14,\n      border: `1px solid ${theme.border}`,\n      color: theme.text,\n      background: theme.sidebarBg || \"rgba(255,255,255,.08)\",\n      cursor: \"pointer\",\n      fontSize: 14\n    },\n    disabled: {\n      opacity: 0.55,\n      cursor: \"not-allowed\"\n    },\n    hintBox: {\n      marginTop: 12,\n      padding: \"10px 12px\",\n      borderRadius: 14,\n      background: theme.sidebarBg || \"rgba(255,255,255,.06)\",\n      border: `1px solid ${theme.border}`,\n      color: theme.textMuted,\n      fontSize: 13,\n      lineHeight: 1.35\n    },\n    agreementRow: {\n      display: \"flex\",\n      alignItems: \"flex-start\",\n      gap: 10,\n      marginTop: 12,\n      marginBottom: 8\n    },\n    agreementLabel: {\n      fontSize: 13,\n      color: theme.textMuted,\n      lineHeight: 1.4,\n      cursor: \"pointer\"\n    },\n    agreementLink: {\n      color: theme.text,\n      textDecoration: \"underline\",\n      marginLeft: 2\n    },\n    footer: {\n      marginTop: 14,\n      display: \"flex\",\n      justifyContent: \"space-between\",\n      gap: 12,\n      color: theme.textMuted,\n      fontSize: 12,\n      flexWrap: \"wrap\"\n    },\n    pill: {\n      padding: \"6px 10px\",\n      borderRadius: 999,\n      border: `1px solid ${theme.border}`,\n      background: theme.sidebarBg || \"rgba(255,255,255,.06)\"\n    },\n    backLink: {\n      color: theme.textMuted,\n      fontSize: 14,\n      marginTop: 16,\n      display: \"block\"\n    }\n  }), [theme, isDark]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: glassStyle.page,\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        ...glassStyle.card,\n        margin: \"20px\"\n      },\n      role: \"region\",\n      \"aria-label\": \"AIST \\u0432\\u0445\\u043E\\u0434\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: glassStyle.shine\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 480,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: glassStyle.header,\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: glassStyle.logo,\n          \"aria-hidden\": \"true\",\n          children: \"AI\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 483,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: glassStyle.titleWrap,\n          children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n            style: glassStyle.title,\n            children: \"AIST\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 487,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            style: glassStyle.subtitle,\n            children: [\"\\u0412\\u0445\\u043E\\u0434 \\u043F\\u043E \\u043A\\u043E\\u0434\\u0443 \\u0438\\u0437 Telegram-\\u0431\\u043E\\u0442\\u0430\", \" \", /*#__PURE__*/_jsxDEV(\"a\", {\n              href: \"https://t.me/AIST_SMS_BOT\",\n              target: \"_blank\",\n              rel: \"noopener noreferrer\",\n              style: {\n                color: theme.accent,\n                textDecoration: 'none',\n                fontWeight: 600\n              },\n              children: \"@AIST_SMS_BOT\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 490,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 488,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 486,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 482,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: glassStyle.tabs,\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"button\",\n          style: {\n            ...glassStyle.tab,\n            ...(authMethod === \"telegram\" ? glassStyle.tabActive : {})\n          },\n          onClick: () => setAuthMethod(\"telegram\"),\n          children: \"\\u041F\\u043E \\u043A\\u043E\\u0434\\u0443 \\u0438\\u0437 Telegram\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 498,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"button\",\n          style: {\n            ...glassStyle.tab,\n            ...(authMethod === \"qr\" ? glassStyle.tabActive : {})\n          },\n          onClick: () => setAuthMethod(\"qr\"),\n          children: \"\\u041F\\u043E QR\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 508,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"button\",\n          style: {\n            ...glassStyle.tab,\n            ...glassStyle.tabDisabled\n          },\n          disabled: true,\n          title: \"\\u0421\\u043A\\u043E\\u0440\\u043E\",\n          children: \"\\u041F\\u043E \\u0421\\u041C\\u0421 (\\u0441\\u043A\\u043E\\u0440\\u043E)\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 518,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 497,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: glassStyle.divider\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 527,\n        columnNumber: 9\n      }, this), confirmQrCode ? /*#__PURE__*/_jsxDEV(\"div\", {\n        style: glassStyle.field,\n        children: token ? /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            style: {\n              ...glassStyle.helper,\n              marginBottom: 12\n            },\n            children: \"\\u041F\\u043E\\u0434\\u0442\\u0432\\u0435\\u0440\\u0434\\u0438\\u0442\\u0435 \\u0432\\u0445\\u043E\\u0434 \\u043D\\u0430 \\u0434\\u0440\\u0443\\u0433\\u043E\\u043C \\u0443\\u0441\\u0442\\u0440\\u043E\\u0439\\u0441\\u0442\\u0432\\u0435 (\\u041F\\u041A). \\u041F\\u043E\\u0441\\u043B\\u0435 \\u043F\\u043E\\u0434\\u0442\\u0432\\u0435\\u0440\\u0436\\u0434\\u0435\\u043D\\u0438\\u044F \\u0447\\u0430\\u0442\\u044B \\u0441\\u0438\\u043D\\u0445\\u0440\\u043E\\u043D\\u0438\\u0437\\u0438\\u0440\\u0443\\u044E\\u0442\\u0441\\u044F.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 533,\n            columnNumber: 17\n          }, this), qrConfirmed ? /*#__PURE__*/_jsxDEV(\"p\", {\n            style: {\n              color: theme.accent,\n              fontWeight: 600\n            },\n            children: \"\\u0413\\u043E\\u0442\\u043E\\u0432\\u043E. \\u041C\\u043E\\u0436\\u0435\\u0442\\u0435 \\u0437\\u0430\\u043A\\u0440\\u044B\\u0442\\u044C \\u044D\\u0442\\u0443 \\u0432\\u043A\\u043B\\u0430\\u0434\\u043A\\u0443.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 537,\n            columnNumber: 19\n          }, this) : /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"button\",\n            disabled: qrConfirming,\n            style: glassStyle.primaryBtn,\n            onClick: async () => {\n              setQrConfirming(true);\n              try {\n                const res = await fetch(`${API_BASE_URL}/api/auth/qr/confirm`, {\n                  method: \"POST\",\n                  headers: {\n                    \"Content-Type\": \"application/json\",\n                    Authorization: `Bearer ${token}`\n                  },\n                  body: JSON.stringify({\n                    code: confirmQrCode\n                  })\n                });\n                const data = await res.json();\n                if (data !== null && data !== void 0 && data.ok) setQrConfirmed(true);else setMessage((data === null || data === void 0 ? void 0 : data.message) || \"Ошибка подтверждения\");\n              } catch (e) {\n                setMessage((e === null || e === void 0 ? void 0 : e.message) || \"Ошибка сети\");\n              }\n              setQrConfirming(false);\n            },\n            children: qrConfirming ? \"Отправка…\" : \"Подтвердить вход на ПК\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 539,\n            columnNumber: 19\n          }, this)]\n        }, void 0, true) : /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            style: {\n              ...glassStyle.helper,\n              marginBottom: 12\n            },\n            children: \"\\u0421\\u043D\\u0430\\u0447\\u0430\\u043B\\u0430 \\u0432\\u043E\\u0439\\u0434\\u0438\\u0442\\u0435 \\u0432 \\u0430\\u043A\\u043A\\u0430\\u0443\\u043D\\u0442 \\u043D\\u0430 \\u044D\\u0442\\u043E\\u043C \\u0443\\u0441\\u0442\\u0440\\u043E\\u0439\\u0441\\u0442\\u0432\\u0435, \\u0437\\u0430\\u0442\\u0435\\u043C \\u043F\\u043E\\u0434\\u0442\\u0432\\u0435\\u0440\\u0434\\u0438\\u0442\\u0435 \\u0432\\u0445\\u043E\\u0434 \\u043D\\u0430 \\u041F\\u041A.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 566,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(Link, {\n            to: \"/login\",\n            style: glassStyle.link,\n            children: \"\\u041F\\u0435\\u0440\\u0435\\u0439\\u0442\\u0438 \\u043A \\u0432\\u0445\\u043E\\u0434\\u0443\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 569,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 530,\n        columnNumber: 11\n      }, this) : authMethod === \"qr\" ? /*#__PURE__*/_jsxDEV(\"div\", {\n        style: glassStyle.field,\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          style: {\n            ...glassStyle.helper,\n            marginBottom: 12\n          },\n          children: \"\\u041E\\u0442\\u043A\\u0440\\u043E\\u0439\\u0442\\u0435 \\u044D\\u0442\\u0443 \\u0441\\u0442\\u0440\\u0430\\u043D\\u0438\\u0446\\u0443 \\u043D\\u0430 \\u0442\\u0435\\u043B\\u0435\\u0444\\u043E\\u043D\\u0435 (\\u0443\\u0436\\u0435 \\u0432\\u043E\\u0439\\u0434\\u044F \\u0432 \\u0430\\u043A\\u043A\\u0430\\u0443\\u043D\\u0442) \\u0438\\u043B\\u0438 \\u043E\\u0442\\u0441\\u043A\\u0430\\u043D\\u0438\\u0440\\u0443\\u0439\\u0442\\u0435 QR \\u043A\\u0430\\u043C\\u0435\\u0440\\u043E\\u0439 \\u2014 \\u0437\\u0430\\u0442\\u0435\\u043C \\u043D\\u0430 \\u0442\\u0435\\u043B\\u0435\\u0444\\u043E\\u043D\\u0435 \\u043D\\u0430\\u0436\\u043C\\u0438\\u0442\\u0435 \\xAB\\u041F\\u043E\\u0434\\u0442\\u0432\\u0435\\u0440\\u0434\\u0438\\u0442\\u044C \\u0432\\u0445\\u043E\\u0434 \\u043D\\u0430 \\u041F\\u041A\\xBB.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 575,\n          columnNumber: 13\n        }, this), qrCode ? /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              padding: 16,\n              background: theme.inputBg,\n              borderRadius: 14,\n              display: \"inline-block\",\n              marginBottom: 12\n            },\n            children: /*#__PURE__*/_jsxDEV(QRCodeSVG, {\n              value: typeof window !== \"undefined\" ? `${window.location.origin}${window.location.pathname || \"/login\"}?confirm-qr=${qrCode}` : \"\",\n              size: 200,\n              level: \"M\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 581,\n              columnNumber: 19\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 580,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            style: {\n              fontSize: 14,\n              color: theme.textMuted,\n              marginBottom: 8\n            },\n            children: [\"\\u041A\\u043E\\u0434: \", /*#__PURE__*/_jsxDEV(\"strong\", {\n              style: {\n                letterSpacing: 2\n              },\n              children: qrCode\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 587,\n              columnNumber: 91\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 587,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            style: {\n              fontSize: 13,\n              color: theme.textMuted\n            },\n            children: [qrStatus === \"pending\" && \"Ожидание подтверждения на телефоне…\", qrStatus === \"expired\" && \"Код истёк. Обновите страницу для нового кода.\", qrStatus === \"error\" && \"Не удалось получить код. Проверьте связь с сервером.\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 588,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true) : /*#__PURE__*/_jsxDEV(\"p\", {\n          style: {\n            color: theme.textMuted\n          },\n          children: qrStatus === \"error\" ? \"Ошибка загрузки кода\" : \"Загрузка кода…\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 595,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 574,\n        columnNumber: 11\n      }, this) : null, !confirmQrCode && authMethod !== \"qr\" && step === \"request\" && /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: glassStyle.field,\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            style: glassStyle.label,\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"\\u041D\\u043E\\u043C\\u0435\\u0440 \\u0442\\u0435\\u043B\\u0435\\u0444\\u043E\\u043D\\u0430\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 604,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              style: glassStyle.helper,\n              children: \"\\u043D\\u0430\\u043F\\u0440\\u0438\\u043C\\u0435\\u0440, +7 999 123-45-67\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 605,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 603,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: glassStyle.inputRow,\n            children: /*#__PURE__*/_jsxDEV(\"input\", {\n              style: glassStyle.input,\n              inputMode: \"tel\",\n              autoComplete: \"tel\",\n              placeholder: \"+7 999 123-45-67\",\n              value: phoneInput,\n              onChange: e => setPhoneInput(e.target.value),\n              onKeyDown: e => {\n                if (e.key === \"Enter\") requestCode();\n              },\n              \"aria-label\": \"\\u041D\\u043E\\u043C\\u0435\\u0440 \\u0442\\u0435\\u043B\\u0435\\u0444\\u043E\\u043D\\u0430\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 608,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 607,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 602,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: glassStyle.buttonsRow,\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"button\",\n            onClick: requestCode,\n            disabled: !canRequest,\n            style: {\n              ...glassStyle.primaryBtn,\n              ...(!canRequest ? glassStyle.disabled : null)\n            },\n            children: busy ? \"Отправляем…\" : cooldown > 0 ? `Подождите ${cooldown}с` : \"Получить код\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 624,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 623,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: glassStyle.hintBox,\n          children: [/*#__PURE__*/_jsxDEV(\"b\", {\n            children: \"\\u0412\\u0430\\u0436\\u043D\\u043E:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 638,\n            columnNumber: 15\n          }, this), \" \\u0421\\u043D\\u0430\\u0447\\u0430\\u043B\\u0430 \\u043E\\u0442\\u043A\\u0440\\u043E\\u0439\\u0442\\u0435 \\u0431\\u043E\\u0442\\u0430 \\u0432 Telegram \\u0438 \\u0430\\u043A\\u0442\\u0438\\u0432\\u0438\\u0440\\u0443\\u0439\\u0442\\u0435 \\u043D\\u043E\\u043C\\u0435\\u0440:\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 639,\n            columnNumber: 15\n          }, this), \"1. \\u041D\\u0430\\u0436\\u043C\\u0438\\u0442\\u0435:\", \" \", /*#__PURE__*/_jsxDEV(\"a\", {\n            href: \"https://t.me/AIST_SMS_BOT\",\n            target: \"_blank\",\n            rel: \"noopener noreferrer\",\n            style: {\n              color: theme.accent,\n              fontWeight: 600\n            },\n            children: \"\\u041E\\u0442\\u043A\\u0440\\u044B\\u0442\\u044C \\u0431\\u043E\\u0442\\u0430 @AIST_SMS_BOT\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 640,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 643,\n            columnNumber: 15\n          }, this), \"2. \\u0412 \\u0431\\u043E\\u0442\\u0435 \\u043D\\u0430\\u0436\\u043C\\u0438\\u0442\\u0435 \", /*#__PURE__*/_jsxDEV(\"b\", {\n            children: \"/start\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 643,\n            columnNumber: 39\n          }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 644,\n            columnNumber: 15\n          }, this), \"3. \\u041E\\u0442\\u043F\\u0440\\u0430\\u0432\\u044C\\u0442\\u0435 \\u043D\\u043E\\u043C\\u0435\\u0440 \\u0442\\u0435\\u043B\\u0435\\u0444\\u043E\\u043D\\u0430 \\u0447\\u0435\\u0440\\u0435\\u0437 \\u043A\\u043D\\u043E\\u043F\\u043A\\u0443 \\u0432 \\u0431\\u043E\\u0442\\u0435\", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 645,\n            columnNumber: 15\n          }, this), \"4. \\u0417\\u0430\\u0442\\u0435\\u043C \\u0432\\u0432\\u0435\\u0434\\u0438\\u0442\\u0435 \\u043D\\u043E\\u043C\\u0435\\u0440 \\u0437\\u0434\\u0435\\u0441\\u044C \\u0438 \\u043D\\u0430\\u0436\\u043C\\u0438\\u0442\\u0435 \\xAB\\u041F\\u043E\\u043B\\u0443\\u0447\\u0438\\u0442\\u044C \\u043A\\u043E\\u0434\\xBB\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 637,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true), !confirmQrCode && authMethod !== \"qr\" && step === \"verify\" && /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: glassStyle.field,\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            style: glassStyle.label,\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"\\u041A\\u043E\\u0434 \\u0438\\u0437 Telegram\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 655,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              style: glassStyle.helper,\n              children: [\"\\u0434\\u043B\\u044F \", formatPhone(phone)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 656,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 654,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: glassStyle.agreementRow,\n            children: [/*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"checkbox\",\n              id: \"agreement\",\n              checked: agreementAccepted,\n              onChange: e => setAgreementAccepted(e.target.checked),\n              style: {\n                marginTop: 4,\n                cursor: \"pointer\"\n              },\n              \"aria-describedby\": \"agreement-text\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 659,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n              id: \"agreement-text\",\n              htmlFor: \"agreement\",\n              style: glassStyle.agreementLabel,\n              children: [\"\\u042F \\u043F\\u0440\\u0438\\u043D\\u0438\\u043C\\u0430\\u044E\", \" \", /*#__PURE__*/_jsxDEV(\"a\", {\n                href: USER_AGREEMENT_URL,\n                target: \"_blank\",\n                rel: \"noopener noreferrer\",\n                style: glassStyle.agreementLink,\n                children: \"\\u043F\\u043E\\u043B\\u044C\\u0437\\u043E\\u0432\\u0430\\u0442\\u0435\\u043B\\u044C\\u0441\\u043A\\u043E\\u0435 \\u0441\\u043E\\u0433\\u043B\\u0430\\u0448\\u0435\\u043D\\u0438\\u0435\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 669,\n                columnNumber: 19\n              }, this), \" \", \"\\u0438 \\u0443\\u0441\\u043B\\u043E\\u0432\\u0438\\u044F \\u043E\\u0431\\u0440\\u0430\\u0431\\u043E\\u0442\\u043A\\u0438 \\u043F\\u0435\\u0440\\u0441\\u043E\\u043D\\u0430\\u043B\\u044C\\u043D\\u044B\\u0445 \\u0434\\u0430\\u043D\\u043D\\u044B\\u0445 (\\u0432 \\u0441\\u043E\\u043E\\u0442\\u0432\\u0435\\u0442\\u0441\\u0442\\u0432\\u0438\\u0438 \\u0441 \\u0437\\u0430\\u043A\\u043E\\u043D\\u043E\\u0434\\u0430\\u0442\\u0435\\u043B\\u044C\\u0441\\u0442\\u0432\\u043E\\u043C \\u0420\\u0424).\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 667,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 658,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            ref: codeInputRef,\n            style: glassStyle.input,\n            inputMode: \"numeric\",\n            autoComplete: \"one-time-code\",\n            placeholder: \"\\u0412\\u0432\\u0435\\u0434\\u0438\\u0442\\u0435 \\u043A\\u043E\\u0434\",\n            value: code,\n            onChange: onCodeChange,\n            onKeyDown: e => {\n              if (e.key === \"Enter\") verifyCode();\n            },\n            \"aria-label\": \"\\u041A\\u043E\\u0434 \\u043F\\u043E\\u0434\\u0442\\u0432\\u0435\\u0440\\u0436\\u0434\\u0435\\u043D\\u0438\\u044F\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 675,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 653,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: glassStyle.buttonsRow,\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"button\",\n            onClick: verifyCode,\n            disabled: !canVerify,\n            style: {\n              ...glassStyle.primaryBtn,\n              ...(!canVerify ? glassStyle.disabled : null)\n            },\n            children: busy ? \"Проверяем…\" : \"Войти\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 691,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"button\",\n            onClick: () => {\n              setStep(\"request\");\n              setPhoneInput(phone);\n              setMessage(\"\");\n            },\n            disabled: busy,\n            style: {\n              ...glassStyle.secondaryBtn,\n              ...(busy ? glassStyle.disabled : null)\n            },\n            children: \"\\u0418\\u0437\\u043C\\u0435\\u043D\\u0438\\u0442\\u044C \\u043D\\u043E\\u043C\\u0435\\u0440\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 703,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"button\",\n            onClick: requestCode,\n            disabled: busy || cooldown > 0,\n            style: {\n              ...glassStyle.secondaryBtn,\n              ...(busy || cooldown > 0 ? glassStyle.disabled : null)\n            },\n            title: cooldown > 0 ? `Повторить можно через ${cooldown}с` : \"Отправить новый код\",\n            children: cooldown > 0 ? `Повторить через ${cooldown}с` : \"Отправить ещё раз\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 719,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 690,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: glassStyle.footer,\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            style: glassStyle.pill,\n            children: maskedDestination ? `Доставка: ${maskedDestination}` : \"Доставка: @AIST_SMS_BOT\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 734,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            style: glassStyle.pill,\n            children: remaining == null ? ttlSeconds ? `Срок: ~${ttlSeconds}с` : \"Срок: 5 минут\" : remaining > 0 ? `Истекает через: ${remaining}с` : \"Код истёк — запросите новый\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 739,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 733,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true), message ? /*#__PURE__*/_jsxDEV(\"div\", {\n        style: glassStyle.hintBox,\n        role: \"status\",\n        \"aria-live\": \"polite\",\n        children: message\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 753,\n        columnNumber: 11\n      }, this) : null, /*#__PURE__*/_jsxDEV(Link, {\n        to: \"/\",\n        style: glassStyle.backLink,\n        children: \"\\u2190 \\u041D\\u0430 \\u0433\\u043B\\u0430\\u0432\\u043D\\u0443\\u044E\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 757,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 479,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 478,\n    columnNumber: 5\n  }, this);\n}\n_s(Register, \"BgkIpJGwHfikIhutQE2IVVzqgSQ=\", false, function () {\n  return [useTheme, useSearchParams];\n});\n_c = Register;\nvar _c;\n$RefreshReg$(_c, \"Register\");","map":{"version":3,"names":["React","useEffect","useMemo","useRef","useState","Link","useSearchParams","QRCodeSVG","useTheme","jsxDEV","_jsxDEV","Fragment","_Fragment","API_BASE_URL","process","env","REACT_APP_API_URL","window","_window$location","location","hostname","USER_AGREEMENT_URL","normalizePhone","input","digitsOnly","String","replace","length","startsWith","substring","isValidPhone","value","normalized","test","formatPhone","postJson","url","body","signal","_json","res","controller","AbortController","timeoutId","setTimeout","abort","addEventListener","clearTimeout","fetch","method","headers","JSON","stringify","e","name","msg","message","includes","Error","json","ok","error","status","statusText","trim","err","payload","Register","_s","theme","isDark","authMethod","setAuthMethod","step","setStep","phoneInput","setPhoneInput","phone","setPhone","code","setCode","agreementAccepted","setAgreementAccepted","busy","setBusy","setMessage","maskedDestination","setMaskedDestination","ttlSeconds","setTtlSeconds","remaining","setRemaining","cooldown","setCooldown","debugCode","setDebugCode","searchParams","setSearchParams","confirmQrCode","get","qrCode","setQrCode","qrStatus","setQrStatus","qrConfirming","setQrConfirming","qrConfirmed","setQrConfirmed","token","localStorage","getItem","abortRef","codeInputRef","qrPollRef","canRequest","canVerify","d","current","t","setInterval","r","clearInterval","c","_codeInputRef$current","_codeInputRef$current2","focus","call","cancelled","data","poll","encodeURIComponent","setItem","assign","id","requestCode","_abortRef$current","_abortRef$current$abo","errorMsg","masked","devCode","verifyCode","_abortRef$current2","_abortRef$current2$ab","normalizedPhone","retryAfterSeconds","retrySec","Math","max","floor","onCodeChange","next","target","slice","glassStyle","page","minHeight","width","display","placeItems","padding","margin","color","text","background","pageBg","backgroundAttachment","overflow","card","borderRadius","cardBg","border","cardBorder","boxShadow","backdropFilter","WebkitBackdropFilter","position","shine","inset","pointerEvents","mixBlendMode","header","gap","alignItems","logo","height","accent","fontWeight","fontSize","accentText","userSelect","titleWrap","flexDirection","title","lineHeight","subtitle","textMuted","tabs","marginBottom","borderBottom","paddingBottom","tab","cursor","tabActive","sidebarBg","tabDisabled","opacity","divider","field","marginTop","label","justifyContent","helper","outline","inputBg","inputBorder","inputRow","gridTemplateColumns","buttonsRow","flexWrap","primaryBtn","flex","secondaryBtn","disabled","hintBox","agreementRow","agreementLabel","agreementLink","textDecoration","marginLeft","footer","pill","backLink","style","children","role","fileName","_jsxFileName","lineNumber","columnNumber","href","rel","type","onClick","Authorization","to","link","origin","pathname","size","level","letterSpacing","inputMode","autoComplete","placeholder","onChange","onKeyDown","key","checked","htmlFor","ref","_c","$RefreshReg$"],"sources":["C:/Users/Vladislav/Documents/GitHub/aist-messenger/src/pages/Register.jsx"],"sourcesContent":["import React, { useEffect, useMemo, useRef, useState } from \"react\";\r\nimport { Link, useSearchParams } from \"react-router-dom\";\r\nimport { QRCodeSVG } from \"qrcode.react\";\r\nimport { useTheme } from \"../context/ThemeContext\";\r\n\r\n/**\r\n * AIST PWA Messenger — Register/Login screen\r\n * Вход по коду из Telegram или (в будущем) по СМС. При входе по коду из ТГ — пользовательское соглашение (законы РФ).\r\n */\r\n\r\nconst API_BASE_URL = process.env.REACT_APP_API_URL || (typeof window !== \"undefined\" && window.location?.hostname === \"localhost\" ? \"http://localhost:3001\" : \"https://api.get-aist.ru\");\r\n\r\nconst USER_AGREEMENT_URL = \"/user-agreement\";\r\n\r\nfunction normalizePhone(input) {\r\n  if (!input) return \"\";\r\n  const digitsOnly = String(input).replace(/\\D/g, \"\");\r\n  \r\n  if (digitsOnly.length === 11 && digitsOnly.startsWith(\"7\")) {\r\n    return \"+\" + digitsOnly;\r\n  } else if (digitsOnly.length === 10) {\r\n    return \"+7\" + digitsOnly;\r\n  } else if (digitsOnly.length === 11 && digitsOnly.startsWith(\"8\")) {\r\n    return \"+7\" + digitsOnly.substring(1);\r\n  }\r\n  return \"\";\r\n}\r\n\r\nfunction isValidPhone(value) {\r\n  const normalized = normalizePhone(value);\r\n  if (!normalized) return false;\r\n  return /^\\+7\\d{10}$/.test(normalized);\r\n}\r\n\r\nfunction formatPhone(value) {\r\n  const normalized = normalizePhone(value);\r\n  if (!normalized) return value;\r\n  return normalized.replace(/^(\\+7)(\\d{3})(\\d{3})(\\d{2})(\\d{2})$/, \"$1 ($2) $3-$4-$5\");\r\n}\r\n\r\nfunction digitsOnly(value) {\r\n  return String(value ?? \"\").replace(/\\D+/g, \"\");\r\n}\r\n\r\nasync function postJson(url, body, { signal } = {}) {\r\n  let res;\r\n  try {\r\n    // Добавляем таймаут 30 секунд\r\n    const controller = new AbortController();\r\n    const timeoutId = setTimeout(() => controller.abort(), 30000);\r\n\r\n    if (signal) {\r\n      signal.addEventListener('abort', () => {\r\n        clearTimeout(timeoutId);\r\n      });\r\n    }\r\n\r\n    res = await fetch(url, {\r\n      method: \"POST\",\r\n      headers: { \"Content-Type\": \"application/json\" },\r\n      body: JSON.stringify(body ?? {}),\r\n      signal: signal || controller.signal,\r\n    });\r\n\r\n    clearTimeout(timeoutId);\r\n  } catch (e) {\r\n    if (e.name === \"AbortError\") throw e;\r\n    const msg = e.message || \"\";\r\n    if (msg.includes(\"Failed to fetch\") || msg.includes(\"Load failed\") || msg.includes(\"NetworkError\")) {\r\n      throw new Error(\"Нет связи с сервером. Проверьте интернет и что бэкенд запущен (например http://localhost:3001). В .env задайте REACT_APP_API_URL.\");\r\n    }\r\n    throw new Error(msg || \"Ошибка сети\");\r\n  }\r\n\r\n  let json = null;\r\n  try {\r\n    json = await res.json();\r\n  } catch {\r\n    // ignore\r\n  }\r\n\r\n  if (!res.ok) {\r\n    const message =\r\n      (json && (json.message || json.error)) ||\r\n      `HTTP ${res.status} ${res.statusText}`.trim();\r\n    const err = new Error(message);\r\n    err.status = res.status;\r\n    err.payload = json;\r\n    throw err;\r\n  }\r\n\r\n  return json ?? {};\r\n}\r\n\r\nexport default function Register() {\r\n  const { theme, isDark } = useTheme();\r\n  const [authMethod, setAuthMethod] = useState(\"telegram\"); // 'telegram' | 'sms' (sms пока заглушка)\r\n  const [step, setStep] = useState(\"request\");\r\n  const [phoneInput, setPhoneInput] = useState(\"\");\r\n  const [phone, setPhone] = useState(\"\");\r\n  const [code, setCode] = useState(\"\");\r\n  const [agreementAccepted, setAgreementAccepted] = useState(false);\r\n  const [busy, setBusy] = useState(false);\r\n  const [message, setMessage] = useState(\"\");\r\n  const [maskedDestination, setMaskedDestination] = useState(\"\");\r\n  const [ttlSeconds, setTtlSeconds] = useState(null);\r\n  const [remaining, setRemaining] = useState(null);\r\n  const [cooldown, setCooldown] = useState(0);\r\n  const [debugCode, setDebugCode] = useState(\"\");\r\n  const [searchParams, setSearchParams] = useSearchParams();\r\n  const confirmQrCode = searchParams.get(\"confirm-qr\") || \"\";\r\n  const [qrCode, setQrCode] = useState(\"\");\r\n  const [qrStatus, setQrStatus] = useState(\"\");\r\n  const [qrConfirming, setQrConfirming] = useState(false);\r\n  const [qrConfirmed, setQrConfirmed] = useState(false);\r\n  const token = typeof window !== \"undefined\" ? localStorage.getItem(\"aist_token\") : null;\r\n\r\n  const abortRef = useRef(null);\r\n  const codeInputRef = useRef(null);\r\n  const qrPollRef = useRef(null);\r\n\r\n  const canRequest = useMemo(() => {\r\n    if (busy) return false;\r\n    if (cooldown > 0) return false;\r\n    return isValidPhone(phoneInput);\r\n  }, [busy, cooldown, phoneInput]);\r\n\r\n  const canVerify = useMemo(() => {\r\n    if (busy) return false;\r\n    if (!agreementAccepted) return false;\r\n    const d = digitsOnly(code);\r\n    return d.length >= 4 && d.length <= 8;\r\n  }, [busy, agreementAccepted, code]);\r\n\r\n  useEffect(() => {\r\n    return () => {\r\n      if (abortRef.current) abortRef.current.abort();\r\n    };\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (remaining == null) return;\r\n    if (remaining <= 0) return;\r\n    const t = setInterval(() => setRemaining((r) => (r == null ? r : r - 1)), 1000);\r\n    return () => clearInterval(t);\r\n  }, [remaining]);\r\n\r\n  useEffect(() => {\r\n    if (cooldown <= 0) return;\r\n    const t = setInterval(() => setCooldown((c) => (c <= 0 ? 0 : c - 1)), 1000);\r\n    return () => clearInterval(t);\r\n  }, [cooldown]);\r\n\r\n  useEffect(() => {\r\n    if (step !== \"verify\") return;\r\n    const t = setTimeout(() => codeInputRef.current?.focus?.(), 50);\r\n    return () => clearTimeout(t);\r\n  }, [step]);\r\n\r\n  // QR: запрос кода при открытии вкладки «По QR» (на ПК)\r\n  useEffect(() => {\r\n    if (authMethod !== \"qr\" || confirmQrCode) return;\r\n    let cancelled = false;\r\n    (async () => {\r\n      try {\r\n        const res = await fetch(`${API_BASE_URL}/api/auth/qr/request`, { method: \"POST\" });\r\n        const data = await res.json();\r\n        if (cancelled || !data?.code) return;\r\n        setQrCode(data.code);\r\n        setQrStatus(\"pending\");\r\n      } catch {\r\n        setQrStatus(\"error\");\r\n      }\r\n    })();\r\n    return () => { cancelled = true; };\r\n  }, [authMethod, confirmQrCode]);\r\n\r\n  // QR: опрос готовности (на ПК)\r\n  useEffect(() => {\r\n    if (!qrCode || qrStatus !== \"pending\") return;\r\n    const poll = async () => {\r\n      try {\r\n        const res = await fetch(`${API_BASE_URL}/api/auth/qr/check?code=${encodeURIComponent(qrCode)}`);\r\n        const data = await res.json();\r\n        if (data?.status === \"ready\" && data?.token) {\r\n          localStorage.setItem(\"aist_token\", data.token);\r\n          window.location.assign(\"/messenger\");\r\n          return;\r\n        }\r\n        if (data?.status === \"expired\") setQrStatus(\"expired\");\r\n      } catch {}\r\n    };\r\n    poll();\r\n    const id = setInterval(poll, 2000);\r\n    qrPollRef.current = id;\r\n    return () => clearInterval(id);\r\n  }, [qrCode, qrStatus]);\r\n\r\n  // Сброс опроса при смене вкладки\r\n  useEffect(() => {\r\n    if (authMethod !== \"qr\") {\r\n      if (qrPollRef.current) clearInterval(qrPollRef.current);\r\n    }\r\n  }, [authMethod]);\r\n\r\n  async function requestCode() {\r\n    setMessage(\"\");\r\n    const normalized = normalizePhone(phoneInput);\r\n    if (!isValidPhone(normalized)) {\r\n      setMessage(\"Введите корректный номер телефона (например, +7 999 123-45-67 или 8 999 123-45-67).\");\r\n      return;\r\n    }\r\n\r\n    setBusy(true);\r\n    abortRef.current?.abort?.();\r\n    const controller = new AbortController();\r\n    abortRef.current = controller;\r\n\r\n    try {\r\n      const data = await postJson(\r\n        `${API_BASE_URL}/api/auth/request-code`,\r\n        { phone: normalized },\r\n        { signal: controller.signal }\r\n      );\r\n\r\n      if (data?.ok === false) {\r\n        const errorMsg = data?.message || \"Не удалось отправить код. Попробуйте ещё раз.\";\r\n        setMessage(errorMsg);\r\n        if (errorMsg.includes(\"не найден\") || errorMsg.includes(\"активируйте\")) {\r\n          setMessage(errorMsg + \" После активации попробуйте снова.\");\r\n        }\r\n        return;\r\n      }\r\n\r\n      setPhone(normalized);\r\n      setMaskedDestination(data?.masked || \"\");\r\n      setTtlSeconds(typeof data?.ttlSeconds === \"number\" ? data.ttlSeconds : 300);\r\n      setRemaining(typeof data?.ttlSeconds === \"number\" ? data.ttlSeconds : 300);\r\n      setCooldown(15);\r\n      const devCode = data?.debugCode != null ? String(data.debugCode) : \"\";\r\n      setDebugCode(devCode);\r\n      setCode(devCode);\r\n      setAgreementAccepted(false);\r\n      setStep(\"verify\");\r\n      if (devCode) {\r\n        setMessage(\"Код для входа (режим разработки): введите его ниже или скопируйте.\");\r\n      } else {\r\n        setMessage(\r\n          data?.masked\r\n            ? `Код отправлен в Telegram на номер ${data.masked}.`\r\n            : \"Код отправлен в Telegram-бот @AIST_SMS_BOT. Введите его здесь.\"\r\n        );\r\n      }\r\n    } catch (err) {\r\n      if (err?.name === \"AbortError\") return;\r\n      setMessage(err?.message || \"Ошибка сети при отправке кода. Проверьте REACT_APP_API_URL и что бэкенд запущен.\");\r\n    } finally {\r\n      setBusy(false);\r\n    }\r\n  }\r\n\r\n  async function verifyCode() {\r\n    setMessage(\"\");\r\n    const normalizedPhone = normalizePhone(phone);\r\n    const d = digitsOnly(code);\r\n    if (!normalizedPhone) {\r\n      setStep(\"request\");\r\n      setMessage(\"Сначала укажите номер телефона и запросите код.\");\r\n      return;\r\n    }\r\n    if (d.length < 4 || d.length > 8) {\r\n      setMessage(\"Введите код из 4–8 цифр.\");\r\n      return;\r\n    }\r\n    if (!agreementAccepted) {\r\n      setMessage(\"Необходимо принять пользовательское соглашение.\");\r\n      return;\r\n    }\r\n\r\n    setBusy(true);\r\n    abortRef.current?.abort?.();\r\n    const controller = new AbortController();\r\n    abortRef.current = controller;\r\n\r\n    try {\r\n      const data = await postJson(\r\n        `${API_BASE_URL}/api/auth/verify-code`,\r\n        { phone: normalizedPhone, code: d },\r\n        { signal: controller.signal }\r\n      );\r\n\r\n      if (data?.ok === false) {\r\n        const errorMsg = data?.message || \"Неверный код или он истёк. Попробуйте ещё раз.\";\r\n        if (typeof data?.retryAfterSeconds === \"number\") {\r\n          const retrySec = Math.max(0, Math.floor(data.retryAfterSeconds));\r\n          setCooldown(retrySec);\r\n          setMessage(`${errorMsg} Повторить можно через ${retrySec} секунд.`);\r\n        } else {\r\n          setMessage(errorMsg);\r\n        }\r\n        return;\r\n      }\r\n\r\n      const token = data?.token;\r\n      if (token) {\r\n        localStorage.setItem(\"aist_token\", token);\r\n      }\r\n\r\n      window.location.assign(\"/messenger\");\r\n    } catch (err) {\r\n      if (err?.name === \"AbortError\") return;\r\n      setMessage(err?.message || \"Ошибка сети при проверке кода.\");\r\n    } finally {\r\n      setBusy(false);\r\n    }\r\n  }\r\n\r\n  function onCodeChange(e) {\r\n    const next = digitsOnly(e.target.value).slice(0, 8);\r\n    setCode(next);\r\n  }\r\n\r\n  const glassStyle = useMemo(\r\n    () => ({\r\n      page: {\r\n        minHeight: \"100vh\",\r\n        width: \"100vw\",\r\n        display: \"grid\",\r\n        placeItems: \"center\",\r\n        padding: \"20px 0\",\r\n        margin: 0,\r\n        color: theme.text,\r\n        background: theme.pageBg,\r\n        backgroundAttachment: \"fixed\",\r\n        overflow: \"auto\",\r\n      },\r\n      card: {\r\n        width: \"min(460px, 92vw)\",\r\n        borderRadius: 22,\r\n        padding: 22,\r\n        background: theme.cardBg,\r\n        border: `1px solid ${theme.cardBorder}`,\r\n        boxShadow: isDark\r\n          ? \"0 18px 60px rgba(0,0,0,.4), inset 0 1px 0 rgba(255,255,255,.08)\"\r\n          : \"0 20px 60px rgba(80,120,180,.18), inset 0 1px 0 rgba(255,255,255,.7)\",\r\n        backdropFilter: \"blur(16px) saturate(140%)\",\r\n        WebkitBackdropFilter: \"blur(16px) saturate(140%)\",\r\n        position: \"relative\",\r\n        overflow: \"hidden\",\r\n      },\r\n      shine: {\r\n        position: \"absolute\",\r\n        inset: \"-2px\",\r\n        background: isDark\r\n          ? \"radial-gradient(500px 240px at 20% 10%, rgba(255,255,255,.12), transparent 60%)\"\r\n          : \"radial-gradient(400px 200px at 80% 0%, rgba(255,255,255,.4), transparent 55%)\",\r\n        pointerEvents: \"none\",\r\n        mixBlendMode: \"overlay\",\r\n      },\r\n      header: { display: \"flex\", gap: 12, alignItems: \"center\" },\r\n      logo: {\r\n        width: 44,\r\n        height: 44,\r\n        borderRadius: 14,\r\n        background: theme.accent,\r\n        border: \"1px solid rgba(255,255,255,.35)\",\r\n        boxShadow: \"0 8px 24px rgba(0,0,0,.2)\",\r\n        display: \"grid\",\r\n        placeItems: \"center\",\r\n        fontWeight: 800,\r\n        fontSize: 16,\r\n        color: theme.accentText,\r\n        userSelect: \"none\",\r\n      },\r\n      titleWrap: { display: \"flex\", flexDirection: \"column\" },\r\n      title: { margin: 0, fontSize: 18, fontWeight: 700, lineHeight: 1.15, color: theme.text },\r\n      subtitle: { margin: \"6px 0 0\", fontSize: 13, color: theme.textMuted, lineHeight: 1.25 },\r\n      tabs: {\r\n        display: \"flex\",\r\n        gap: 8,\r\n        marginBottom: 16,\r\n        borderBottom: `1px solid ${theme.border}`,\r\n        paddingBottom: 12,\r\n      },\r\n      tab: {\r\n        padding: \"8px 14px\",\r\n        borderRadius: 12,\r\n        border: \"none\",\r\n        background: \"transparent\",\r\n        color: theme.textMuted,\r\n        fontSize: 14,\r\n        cursor: \"pointer\",\r\n      },\r\n      tabActive: { color: theme.text, background: theme.sidebarBg || theme.cardBg, fontWeight: 600 },\r\n      tabDisabled: { opacity: 0.5, cursor: \"not-allowed\" },\r\n      divider: {\r\n        height: 1,\r\n        background: `linear-gradient(90deg, transparent, ${theme.border}, transparent)`,\r\n        margin: \"16px 0\",\r\n      },\r\n      field: { display: \"grid\", gap: 8, marginTop: 12 },\r\n      label: { fontSize: 12, color: theme.textMuted, display: \"flex\", justifyContent: \"space-between\", gap: 12 },\r\n      helper: { fontSize: 12, color: theme.textMuted, opacity: 0.9 },\r\n      input: {\r\n        width: \"100%\",\r\n        padding: \"12px 14px\",\r\n        borderRadius: 14,\r\n        outline: \"none\",\r\n        color: theme.text,\r\n        background: theme.inputBg,\r\n        border: `1px solid ${theme.inputBorder}`,\r\n        fontSize: 14,\r\n      },\r\n      inputRow: { display: \"grid\", gridTemplateColumns: \"1fr\", gap: 10 },\r\n      buttonsRow: { display: \"flex\", gap: 10, marginTop: 14, flexWrap: \"wrap\" },\r\n      primaryBtn: {\r\n        flex: \"1 1 160px\",\r\n        padding: \"12px 14px\",\r\n        borderRadius: 14,\r\n        border: \"1px solid rgba(255,255,255,.25)\",\r\n        color: theme.accentText,\r\n        background: theme.accent,\r\n        boxShadow: \"0 10px 30px rgba(0,0,0,.2)\",\r\n        fontWeight: 600,\r\n        cursor: \"pointer\",\r\n      },\r\n      secondaryBtn: {\r\n        flex: \"1 1 160px\",\r\n        padding: \"12px 14px\",\r\n        borderRadius: 14,\r\n        border: `1px solid ${theme.border}`,\r\n        color: theme.text,\r\n        background: theme.sidebarBg || \"rgba(255,255,255,.08)\",\r\n        cursor: \"pointer\",\r\n        fontSize: 14,\r\n      },\r\n      disabled: { opacity: 0.55, cursor: \"not-allowed\" },\r\n      hintBox: {\r\n        marginTop: 12,\r\n        padding: \"10px 12px\",\r\n        borderRadius: 14,\r\n        background: theme.sidebarBg || \"rgba(255,255,255,.06)\",\r\n        border: `1px solid ${theme.border}`,\r\n        color: theme.textMuted,\r\n        fontSize: 13,\r\n        lineHeight: 1.35,\r\n      },\r\n      agreementRow: {\r\n        display: \"flex\",\r\n        alignItems: \"flex-start\",\r\n        gap: 10,\r\n        marginTop: 12,\r\n        marginBottom: 8,\r\n      },\r\n      agreementLabel: { fontSize: 13, color: theme.textMuted, lineHeight: 1.4, cursor: \"pointer\" },\r\n      agreementLink: { color: theme.text, textDecoration: \"underline\", marginLeft: 2 },\r\n      footer: {\r\n        marginTop: 14,\r\n        display: \"flex\",\r\n        justifyContent: \"space-between\",\r\n        gap: 12,\r\n        color: theme.textMuted,\r\n        fontSize: 12,\r\n        flexWrap: \"wrap\",\r\n      },\r\n      pill: {\r\n        padding: \"6px 10px\",\r\n        borderRadius: 999,\r\n        border: `1px solid ${theme.border}`,\r\n        background: theme.sidebarBg || \"rgba(255,255,255,.06)\",\r\n      },\r\n      backLink: { color: theme.textMuted, fontSize: 14, marginTop: 16, display: \"block\" },\r\n    }),\r\n    [theme, isDark]\r\n  );\r\n\r\n  return (\r\n    <div style={glassStyle.page}>\r\n      <div style={{ ...glassStyle.card, margin: \"20px\" }} role=\"region\" aria-label=\"AIST вход\">\r\n        <div style={glassStyle.shine} />\r\n\r\n        <div style={glassStyle.header}>\r\n          <div style={glassStyle.logo} aria-hidden=\"true\">\r\n            AI\r\n          </div>\r\n          <div style={glassStyle.titleWrap}>\r\n            <h1 style={glassStyle.title}>AIST</h1>\r\n            <p style={glassStyle.subtitle}>\r\n              Вход по коду из Telegram-бота{\" \"}\r\n              <a href=\"https://t.me/AIST_SMS_BOT\" target=\"_blank\" rel=\"noopener noreferrer\" style={{ color: theme.accent, textDecoration: 'none', fontWeight: 600 }}>\r\n                @AIST_SMS_BOT\r\n              </a>\r\n            </p>\r\n          </div>\r\n        </div>\r\n\r\n        <div style={glassStyle.tabs}>\r\n          <button\r\n            type=\"button\"\r\n            style={{\r\n              ...glassStyle.tab,\r\n              ...(authMethod === \"telegram\" ? glassStyle.tabActive : {}),\r\n            }}\r\n            onClick={() => setAuthMethod(\"telegram\")}\r\n          >\r\n            По коду из Telegram\r\n          </button>\r\n          <button\r\n            type=\"button\"\r\n            style={{\r\n              ...glassStyle.tab,\r\n              ...(authMethod === \"qr\" ? glassStyle.tabActive : {}),\r\n            }}\r\n            onClick={() => setAuthMethod(\"qr\")}\r\n          >\r\n            По QR\r\n          </button>\r\n          <button\r\n            type=\"button\"\r\n            style={{ ...glassStyle.tab, ...glassStyle.tabDisabled }}\r\n            disabled\r\n            title=\"Скоро\"\r\n          >\r\n            По СМС (скоро)\r\n          </button>\r\n        </div>\r\n        <div style={glassStyle.divider} />\r\n\r\n        {confirmQrCode ? (\r\n          <div style={glassStyle.field}>\r\n            {token ? (\r\n              <>\r\n                <p style={{ ...glassStyle.helper, marginBottom: 12 }}>\r\n                  Подтвердите вход на другом устройстве (ПК). После подтверждения чаты синхронизируются.\r\n                </p>\r\n                {qrConfirmed ? (\r\n                  <p style={{ color: theme.accent, fontWeight: 600 }}>Готово. Можете закрыть эту вкладку.</p>\r\n                ) : (\r\n                  <button\r\n                    type=\"button\"\r\n                    disabled={qrConfirming}\r\n                    style={glassStyle.primaryBtn}\r\n                    onClick={async () => {\r\n                      setQrConfirming(true);\r\n                      try {\r\n                        const res = await fetch(`${API_BASE_URL}/api/auth/qr/confirm`, {\r\n                          method: \"POST\",\r\n                          headers: { \"Content-Type\": \"application/json\", Authorization: `Bearer ${token}` },\r\n                          body: JSON.stringify({ code: confirmQrCode }),\r\n                        });\r\n                        const data = await res.json();\r\n                        if (data?.ok) setQrConfirmed(true);\r\n                        else setMessage(data?.message || \"Ошибка подтверждения\");\r\n                      } catch (e) {\r\n                        setMessage(e?.message || \"Ошибка сети\");\r\n                      }\r\n                      setQrConfirming(false);\r\n                    }}\r\n                  >\r\n                    {qrConfirming ? \"Отправка…\" : \"Подтвердить вход на ПК\"}\r\n                  </button>\r\n                )}\r\n              </>\r\n            ) : (\r\n              <>\r\n                <p style={{ ...glassStyle.helper, marginBottom: 12 }}>\r\n                  Сначала войдите в аккаунт на этом устройстве, затем подтвердите вход на ПК.\r\n                </p>\r\n                <Link to=\"/login\" style={glassStyle.link}>Перейти к входу</Link>\r\n              </>\r\n            )}\r\n          </div>\r\n        ) : authMethod === \"qr\" ? (\r\n          <div style={glassStyle.field}>\r\n            <p style={{ ...glassStyle.helper, marginBottom: 12 }}>\r\n              Откройте эту страницу на телефоне (уже войдя в аккаунт) или отсканируйте QR камерой — затем на телефоне нажмите «Подтвердить вход на ПК».\r\n            </p>\r\n            {qrCode ? (\r\n              <>\r\n                <div style={{ padding: 16, background: theme.inputBg, borderRadius: 14, display: \"inline-block\", marginBottom: 12 }}>\r\n                  <QRCodeSVG\r\n                    value={typeof window !== \"undefined\" ? `${window.location.origin}${window.location.pathname || \"/login\"}?confirm-qr=${qrCode}` : \"\"}\r\n                    size={200}\r\n                    level=\"M\"\r\n                  />\r\n                </div>\r\n                <p style={{ fontSize: 14, color: theme.textMuted, marginBottom: 8 }}>Код: <strong style={{ letterSpacing: 2 }}>{qrCode}</strong></p>\r\n                <p style={{ fontSize: 13, color: theme.textMuted }}>\r\n                  {qrStatus === \"pending\" && \"Ожидание подтверждения на телефоне…\"}\r\n                  {qrStatus === \"expired\" && \"Код истёк. Обновите страницу для нового кода.\"}\r\n                  {qrStatus === \"error\" && \"Не удалось получить код. Проверьте связь с сервером.\"}\r\n                </p>\r\n              </>\r\n            ) : (\r\n              <p style={{ color: theme.textMuted }}>{qrStatus === \"error\" ? \"Ошибка загрузки кода\" : \"Загрузка кода…\"}</p>\r\n            )}\r\n          </div>\r\n        ) : null}\r\n\r\n        {!confirmQrCode && authMethod !== \"qr\" && step === \"request\" && (\r\n          <>\r\n            <div style={glassStyle.field}>\r\n              <div style={glassStyle.label}>\r\n                <span>Номер телефона</span>\r\n                <span style={glassStyle.helper}>например, +7 999 123-45-67</span>\r\n              </div>\r\n              <div style={glassStyle.inputRow}>\r\n                <input\r\n                  style={glassStyle.input}\r\n                  inputMode=\"tel\"\r\n                  autoComplete=\"tel\"\r\n                  placeholder=\"+7 999 123-45-67\"\r\n                  value={phoneInput}\r\n                  onChange={(e) => setPhoneInput(e.target.value)}\r\n                  onKeyDown={(e) => {\r\n                    if (e.key === \"Enter\") requestCode();\r\n                  }}\r\n                  aria-label=\"Номер телефона\"\r\n                />\r\n              </div>\r\n            </div>\r\n\r\n            <div style={glassStyle.buttonsRow}>\r\n              <button\r\n                type=\"button\"\r\n                onClick={requestCode}\r\n                disabled={!canRequest}\r\n                style={{\r\n                  ...glassStyle.primaryBtn,\r\n                  ...(!canRequest ? glassStyle.disabled : null),\r\n                }}\r\n              >\r\n                {busy ? \"Отправляем…\" : cooldown > 0 ? `Подождите ${cooldown}с` : \"Получить код\"}\r\n              </button>\r\n            </div>\r\n\r\n            <div style={glassStyle.hintBox}>\r\n              <b>Важно:</b> Сначала откройте бота в Telegram и активируйте номер:\r\n              <br />1. Нажмите:{\" \"}\r\n              <a href=\"https://t.me/AIST_SMS_BOT\" target=\"_blank\" rel=\"noopener noreferrer\" style={{ color: theme.accent, fontWeight: 600 }}>\r\n                Открыть бота @AIST_SMS_BOT\r\n              </a>\r\n              <br />2. В боте нажмите <b>/start</b>\r\n              <br />3. Отправьте номер телефона через кнопку в боте\r\n              <br />4. Затем введите номер здесь и нажмите «Получить код»\r\n            </div>\r\n          </>\r\n        )}\r\n\r\n        {!confirmQrCode && authMethod !== \"qr\" && step === \"verify\" && (\r\n          <>\r\n            {/* debugCode показывается только в development режиме */}\r\n            <div style={glassStyle.field}>\r\n              <div style={glassStyle.label}>\r\n                <span>Код из Telegram</span>\r\n                <span style={glassStyle.helper}>для {formatPhone(phone)}</span>\r\n              </div>\r\n              <div style={glassStyle.agreementRow}>\r\n                <input\r\n                  type=\"checkbox\"\r\n                  id=\"agreement\"\r\n                  checked={agreementAccepted}\r\n                  onChange={(e) => setAgreementAccepted(e.target.checked)}\r\n                  style={{ marginTop: 4, cursor: \"pointer\" }}\r\n                  aria-describedby=\"agreement-text\"\r\n                />\r\n                <label id=\"agreement-text\" htmlFor=\"agreement\" style={glassStyle.agreementLabel}>\r\n                  Я принимаю{\" \"}\r\n                  <a href={USER_AGREEMENT_URL} target=\"_blank\" rel=\"noopener noreferrer\" style={glassStyle.agreementLink}>\r\n                    пользовательское соглашение\r\n                  </a>{\" \"}\r\n                  и условия обработки персональных данных (в соответствии с законодательством РФ).\r\n                </label>\r\n              </div>\r\n              <input\r\n                ref={codeInputRef}\r\n                style={glassStyle.input}\r\n                inputMode=\"numeric\"\r\n                autoComplete=\"one-time-code\"\r\n                placeholder=\"Введите код\"\r\n                value={code}\r\n                onChange={onCodeChange}\r\n                onKeyDown={(e) => {\r\n                  if (e.key === \"Enter\") verifyCode();\r\n                }}\r\n                aria-label=\"Код подтверждения\"\r\n              />\r\n            </div>\r\n\r\n            <div style={glassStyle.buttonsRow}>\r\n              <button\r\n                type=\"button\"\r\n                onClick={verifyCode}\r\n                disabled={!canVerify}\r\n                style={{\r\n                  ...glassStyle.primaryBtn,\r\n                  ...(!canVerify ? glassStyle.disabled : null),\r\n                }}\r\n              >\r\n                {busy ? \"Проверяем…\" : \"Войти\"}\r\n              </button>\r\n\r\n              <button\r\n                type=\"button\"\r\n                onClick={() => {\r\n                  setStep(\"request\");\r\n                  setPhoneInput(phone);\r\n                  setMessage(\"\");\r\n                }}\r\n                disabled={busy}\r\n                style={{\r\n                  ...glassStyle.secondaryBtn,\r\n                  ...(busy ? glassStyle.disabled : null),\r\n                }}\r\n              >\r\n                Изменить номер\r\n              </button>\r\n\r\n              <button\r\n                type=\"button\"\r\n                onClick={requestCode}\r\n                disabled={busy || cooldown > 0}\r\n                style={{\r\n                  ...glassStyle.secondaryBtn,\r\n                  ...(busy || cooldown > 0 ? glassStyle.disabled : null),\r\n                }}\r\n                title={cooldown > 0 ? `Повторить можно через ${cooldown}с` : \"Отправить новый код\"}\r\n              >\r\n                {cooldown > 0 ? `Повторить через ${cooldown}с` : \"Отправить ещё раз\"}\r\n              </button>\r\n            </div>\r\n\r\n            <div style={glassStyle.footer}>\r\n              <span style={glassStyle.pill}>\r\n                {maskedDestination\r\n                  ? `Доставка: ${maskedDestination}`\r\n                  : \"Доставка: @AIST_SMS_BOT\"}\r\n              </span>\r\n              <span style={glassStyle.pill}>\r\n                {remaining == null\r\n                  ? ttlSeconds\r\n                    ? `Срок: ~${ttlSeconds}с`\r\n                    : \"Срок: 5 минут\"\r\n                  : remaining > 0\r\n                    ? `Истекает через: ${remaining}с`\r\n                    : \"Код истёк — запросите новый\"}\r\n              </span>\r\n            </div>\r\n          </>\r\n        )}\r\n\r\n        {message ? (\r\n          <div style={glassStyle.hintBox} role=\"status\" aria-live=\"polite\">\r\n            {message}\r\n          </div>\r\n        ) : null}\r\n        <Link to=\"/\" style={glassStyle.backLink}>\r\n          ← На главную\r\n        </Link>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}