{"ast":null,"code":"import _objectSpread from\"C:/Users/Vladislav/Documents/GitHub/aist-messenger/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";var _window$location;import React,{useEffect,useMemo,useRef,useState}from\"react\";import{Link}from\"react-router-dom\";import{QRCodeSVG}from\"qrcode.react\";import{useTheme}from\"../context/ThemeContext\";/**\r\n * AIST PWA Messenger — Register/Login screen\r\n * Вход по коду из Telegram или (в будущем) по СМС. При входе по коду из ТГ — пользовательское соглашение (законы РФ).\r\n */import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const API_BASE_URL=process.env.REACT_APP_API_URL||(typeof window!==\"undefined\"&&((_window$location=window.location)===null||_window$location===void 0?void 0:_window$location.hostname)===\"localhost\"?\"http://localhost:3001\":\"https://api.get-aist.ru\");const USER_AGREEMENT_URL=\"/user-agreement\";function normalizePhone(input){if(!input)return\"\";const digitsOnly=String(input).replace(/\\D/g,\"\");if(digitsOnly.length===11&&digitsOnly.startsWith(\"7\")){return\"+\"+digitsOnly;}else if(digitsOnly.length===10){return\"+7\"+digitsOnly;}else if(digitsOnly.length===11&&digitsOnly.startsWith(\"8\")){return\"+7\"+digitsOnly.substring(1);}return\"\";}function isValidPhone(value){const normalized=normalizePhone(value);if(!normalized)return false;return /^\\+7\\d{10}$/.test(normalized);}function formatPhone(value){const normalized=normalizePhone(value);if(!normalized)return value;return normalized.replace(/^(\\+7)(\\d{3})(\\d{3})(\\d{2})(\\d{2})$/,\"$1 ($2) $3-$4-$5\");}function digitsOnly(value){return String(value!==null&&value!==void 0?value:\"\").replace(/\\D+/g,\"\");}async function postJson(url,body){var _json;let{signal}=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};let res;try{res=await fetch(url,{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify(body!==null&&body!==void 0?body:{}),signal});}catch(e){if(e.name===\"AbortError\")throw e;const msg=e.message||\"\";if(msg.includes(\"Failed to fetch\")||msg.includes(\"Load failed\")||msg.includes(\"NetworkError\")){throw new Error(\"Нет связи с сервером. Проверьте интернет и что бэкенд запущен (например http://localhost:3001). В .env задайте REACT_APP_API_URL.\");}throw new Error(msg||\"Ошибка сети\");}let json=null;try{json=await res.json();}catch(_unused){// ignore\n}if(!res.ok){const message=json&&(json.message||json.error)||\"HTTP \".concat(res.status,\" \").concat(res.statusText).trim();const err=new Error(message);err.status=res.status;err.payload=json;throw err;}return(_json=json)!==null&&_json!==void 0?_json:{};}export default function Register(){const{theme,isDark}=useTheme();const[authMethod,setAuthMethod]=useState(\"telegram\");// 'telegram' | 'sms' (sms пока заглушка)\nconst[step,setStep]=useState(\"request\");const[phoneInput,setPhoneInput]=useState(\"\");const[phone,setPhone]=useState(\"\");const[code,setCode]=useState(\"\");const[agreementAccepted,setAgreementAccepted]=useState(false);const[busy,setBusy]=useState(false);const[message,setMessage]=useState(\"\");const[maskedDestination,setMaskedDestination]=useState(\"\");const[ttlSeconds,setTtlSeconds]=useState(null);const[remaining,setRemaining]=useState(null);const[cooldown,setCooldown]=useState(0);const[debugCode,setDebugCode]=useState(\"\");// если бэкенд вернул debugCode — показываем для теста\nconst abortRef=useRef(null);const codeInputRef=useRef(null);const canRequest=useMemo(()=>{if(busy)return false;if(cooldown>0)return false;return isValidPhone(phoneInput);},[busy,cooldown,phoneInput]);const canVerify=useMemo(()=>{if(busy)return false;if(!agreementAccepted)return false;const d=digitsOnly(code);return d.length>=4&&d.length<=8;},[busy,agreementAccepted,code]);useEffect(()=>{return()=>{if(abortRef.current)abortRef.current.abort();};},[]);useEffect(()=>{if(remaining==null)return;if(remaining<=0)return;const t=setInterval(()=>setRemaining(r=>r==null?r:r-1),1000);return()=>clearInterval(t);},[remaining]);useEffect(()=>{if(cooldown<=0)return;const t=setInterval(()=>setCooldown(c=>c<=0?0:c-1),1000);return()=>clearInterval(t);},[cooldown]);useEffect(()=>{if(step!==\"verify\")return;const t=setTimeout(()=>{var _codeInputRef$current,_codeInputRef$current2;return(_codeInputRef$current=codeInputRef.current)===null||_codeInputRef$current===void 0?void 0:(_codeInputRef$current2=_codeInputRef$current.focus)===null||_codeInputRef$current2===void 0?void 0:_codeInputRef$current2.call(_codeInputRef$current);},50);return()=>clearTimeout(t);},[step]);async function requestCode(){var _abortRef$current,_abortRef$current$abo;setMessage(\"\");const normalized=normalizePhone(phoneInput);if(!isValidPhone(normalized)){setMessage(\"Введите корректный номер телефона (например, +7 999 123-45-67 или 8 999 123-45-67).\");return;}setBusy(true);(_abortRef$current=abortRef.current)===null||_abortRef$current===void 0?void 0:(_abortRef$current$abo=_abortRef$current.abort)===null||_abortRef$current$abo===void 0?void 0:_abortRef$current$abo.call(_abortRef$current);const controller=new AbortController();abortRef.current=controller;try{const data=await postJson(\"\".concat(API_BASE_URL,\"/api/auth/request-code\"),{phone:normalized},{signal:controller.signal});if((data===null||data===void 0?void 0:data.ok)===false){const errorMsg=(data===null||data===void 0?void 0:data.message)||\"Не удалось отправить код. Попробуйте ещё раз.\";setMessage(errorMsg);if(errorMsg.includes(\"не найден\")||errorMsg.includes(\"активируйте\")){setMessage(errorMsg+\" После активации попробуйте снова.\");}return;}setPhone(normalized);setMaskedDestination((data===null||data===void 0?void 0:data.masked)||\"\");setTtlSeconds(typeof(data===null||data===void 0?void 0:data.ttlSeconds)===\"number\"?data.ttlSeconds:300);setRemaining(typeof(data===null||data===void 0?void 0:data.ttlSeconds)===\"number\"?data.ttlSeconds:300);setCooldown(15);const devCode=(data===null||data===void 0?void 0:data.debugCode)!=null?String(data.debugCode):\"\";setDebugCode(devCode);setCode(devCode);setAgreementAccepted(false);setStep(\"verify\");if(devCode){setMessage(\"Код для входа (режим разработки): введите его ниже или скопируйте.\");}else{setMessage(data!==null&&data!==void 0&&data.masked?\"\\u041A\\u043E\\u0434 \\u043E\\u0442\\u043F\\u0440\\u0430\\u0432\\u043B\\u0435\\u043D \\u0432 Telegram \\u043D\\u0430 \\u043D\\u043E\\u043C\\u0435\\u0440 \".concat(data.masked,\".\"):\"Код отправлен в Telegram-бот @AIST_SMS_BOT. Введите его здесь.\");}}catch(err){if((err===null||err===void 0?void 0:err.name)===\"AbortError\")return;setMessage((err===null||err===void 0?void 0:err.message)||\"Ошибка сети при отправке кода. Проверьте REACT_APP_API_URL и что бэкенд запущен.\");}finally{setBusy(false);}}async function verifyCode(){var _abortRef$current2,_abortRef$current2$ab;setMessage(\"\");const normalizedPhone=normalizePhone(phone);const d=digitsOnly(code);if(!normalizedPhone){setStep(\"request\");setMessage(\"Сначала укажите номер телефона и запросите код.\");return;}if(d.length<4||d.length>8){setMessage(\"Введите код из 4–8 цифр.\");return;}if(!agreementAccepted){setMessage(\"Необходимо принять пользовательское соглашение.\");return;}setBusy(true);(_abortRef$current2=abortRef.current)===null||_abortRef$current2===void 0?void 0:(_abortRef$current2$ab=_abortRef$current2.abort)===null||_abortRef$current2$ab===void 0?void 0:_abortRef$current2$ab.call(_abortRef$current2);const controller=new AbortController();abortRef.current=controller;try{const data=await postJson(\"\".concat(API_BASE_URL,\"/api/auth/verify-code\"),{phone:normalizedPhone,code:d},{signal:controller.signal});if((data===null||data===void 0?void 0:data.ok)===false){const errorMsg=(data===null||data===void 0?void 0:data.message)||\"Неверный код или он истёк. Попробуйте ещё раз.\";if(typeof(data===null||data===void 0?void 0:data.retryAfterSeconds)===\"number\"){const retrySec=Math.max(0,Math.floor(data.retryAfterSeconds));setCooldown(retrySec);setMessage(\"\".concat(errorMsg,\" \\u041F\\u043E\\u0432\\u0442\\u043E\\u0440\\u0438\\u0442\\u044C \\u043C\\u043E\\u0436\\u043D\\u043E \\u0447\\u0435\\u0440\\u0435\\u0437 \").concat(retrySec,\" \\u0441\\u0435\\u043A\\u0443\\u043D\\u0434.\"));}else{setMessage(errorMsg);}return;}const token=data===null||data===void 0?void 0:data.token;if(token){localStorage.setItem(\"aist_token\",token);}window.location.assign(\"/messenger\");}catch(err){if((err===null||err===void 0?void 0:err.name)===\"AbortError\")return;setMessage((err===null||err===void 0?void 0:err.message)||\"Ошибка сети при проверке кода.\");}finally{setBusy(false);}}function onCodeChange(e){const next=digitsOnly(e.target.value).slice(0,8);setCode(next);}const glassStyle=useMemo(()=>({page:{minHeight:\"100vh\",width:\"100vw\",display:\"grid\",placeItems:\"center\",padding:\"20px 0\",margin:0,color:theme.text,background:theme.pageBg,backgroundAttachment:\"fixed\",overflow:\"auto\"},card:{width:\"min(460px, 92vw)\",borderRadius:22,padding:22,background:theme.cardBg,border:\"1px solid \".concat(theme.cardBorder),boxShadow:isDark?\"0 18px 60px rgba(0,0,0,.4), inset 0 1px 0 rgba(255,255,255,.08)\":\"0 20px 60px rgba(80,120,180,.18), inset 0 1px 0 rgba(255,255,255,.7)\",backdropFilter:\"blur(16px) saturate(140%)\",WebkitBackdropFilter:\"blur(16px) saturate(140%)\",position:\"relative\",overflow:\"hidden\"},shine:{position:\"absolute\",inset:\"-2px\",background:isDark?\"radial-gradient(500px 240px at 20% 10%, rgba(255,255,255,.12), transparent 60%)\":\"radial-gradient(400px 200px at 80% 0%, rgba(255,255,255,.4), transparent 55%)\",pointerEvents:\"none\",mixBlendMode:\"overlay\"},header:{display:\"flex\",gap:12,alignItems:\"center\"},logo:{width:44,height:44,borderRadius:14,background:theme.accent,border:\"1px solid rgba(255,255,255,.35)\",boxShadow:\"0 8px 24px rgba(0,0,0,.2)\",display:\"grid\",placeItems:\"center\",fontWeight:800,fontSize:16,color:theme.accentText,userSelect:\"none\"},titleWrap:{display:\"flex\",flexDirection:\"column\"},title:{margin:0,fontSize:18,fontWeight:700,lineHeight:1.15,color:theme.text},subtitle:{margin:\"6px 0 0\",fontSize:13,color:theme.textMuted,lineHeight:1.25},tabs:{display:\"flex\",gap:8,marginBottom:16,borderBottom:\"1px solid \".concat(theme.border),paddingBottom:12},tab:{padding:\"8px 14px\",borderRadius:12,border:\"none\",background:\"transparent\",color:theme.textMuted,fontSize:14,cursor:\"pointer\"},tabActive:{color:theme.text,background:theme.sidebarBg||theme.cardBg,fontWeight:600},tabDisabled:{opacity:0.5,cursor:\"not-allowed\"},divider:{height:1,background:\"linear-gradient(90deg, transparent, \".concat(theme.border,\", transparent)\"),margin:\"16px 0\"},field:{display:\"grid\",gap:8,marginTop:12},label:{fontSize:12,color:theme.textMuted,display:\"flex\",justifyContent:\"space-between\",gap:12},helper:{fontSize:12,color:theme.textMuted,opacity:0.9},input:{width:\"100%\",padding:\"12px 14px\",borderRadius:14,outline:\"none\",color:theme.text,background:theme.inputBg,border:\"1px solid \".concat(theme.inputBorder),fontSize:14},inputRow:{display:\"grid\",gridTemplateColumns:\"1fr\",gap:10},buttonsRow:{display:\"flex\",gap:10,marginTop:14,flexWrap:\"wrap\"},primaryBtn:{flex:\"1 1 160px\",padding:\"12px 14px\",borderRadius:14,border:\"1px solid rgba(255,255,255,.25)\",color:theme.accentText,background:theme.accent,boxShadow:\"0 10px 30px rgba(0,0,0,.2)\",fontWeight:600,cursor:\"pointer\"},secondaryBtn:{flex:\"1 1 160px\",padding:\"12px 14px\",borderRadius:14,border:\"1px solid \".concat(theme.border),color:theme.text,background:theme.sidebarBg||\"rgba(255,255,255,.08)\",cursor:\"pointer\",fontSize:14},disabled:{opacity:0.55,cursor:\"not-allowed\"},hintBox:{marginTop:12,padding:\"10px 12px\",borderRadius:14,background:theme.sidebarBg||\"rgba(255,255,255,.06)\",border:\"1px solid \".concat(theme.border),color:theme.textMuted,fontSize:13,lineHeight:1.35},agreementRow:{display:\"flex\",alignItems:\"flex-start\",gap:10,marginTop:12,marginBottom:8},agreementLabel:{fontSize:13,color:theme.textMuted,lineHeight:1.4,cursor:\"pointer\"},agreementLink:{color:theme.text,textDecoration:\"underline\",marginLeft:2},footer:{marginTop:14,display:\"flex\",justifyContent:\"space-between\",gap:12,color:theme.textMuted,fontSize:12,flexWrap:\"wrap\"},pill:{padding:\"6px 10px\",borderRadius:999,border:\"1px solid \".concat(theme.border),background:theme.sidebarBg||\"rgba(255,255,255,.06)\"},backLink:{color:theme.textMuted,fontSize:14,marginTop:16,display:\"block\"}}),[theme,isDark]);return/*#__PURE__*/_jsx(\"div\",{style:glassStyle.page,children:/*#__PURE__*/_jsxs(\"div\",{style:_objectSpread(_objectSpread({},glassStyle.card),{},{margin:\"20px\"}),role:\"region\",\"aria-label\":\"AIST \\u0432\\u0445\\u043E\\u0434\",children:[/*#__PURE__*/_jsx(\"div\",{style:glassStyle.shine}),/*#__PURE__*/_jsxs(\"div\",{style:glassStyle.header,children:[/*#__PURE__*/_jsx(\"div\",{style:glassStyle.logo,\"aria-hidden\":\"true\",children:\"AI\"}),/*#__PURE__*/_jsxs(\"div\",{style:glassStyle.titleWrap,children:[/*#__PURE__*/_jsx(\"h1\",{style:glassStyle.title,children:\"AIST\"}),/*#__PURE__*/_jsx(\"p\",{style:glassStyle.subtitle,children:\"\\u0412\\u0445\\u043E\\u0434 \\u043F\\u043E \\u043A\\u043E\\u0434\\u0443 \\u0438\\u0437 Telegram-\\u0431\\u043E\\u0442\\u0430 @AIST_SMS_BOT\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{style:glassStyle.tabs,children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",style:_objectSpread(_objectSpread({},glassStyle.tab),authMethod===\"telegram\"?glassStyle.tabActive:{}),onClick:()=>setAuthMethod(\"telegram\"),children:\"\\u041F\\u043E \\u043A\\u043E\\u0434\\u0443 \\u0438\\u0437 Telegram\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",style:_objectSpread(_objectSpread({},glassStyle.tab),authMethod===\"qr\"?glassStyle.tabActive:{}),onClick:()=>setAuthMethod(\"qr\"),children:\"\\u041F\\u043E QR\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",style:_objectSpread(_objectSpread({},glassStyle.tab),glassStyle.tabDisabled),disabled:true,title:\"\\u0421\\u043A\\u043E\\u0440\\u043E\",children:\"\\u041F\\u043E \\u0421\\u041C\\u0421 (\\u0441\\u043A\\u043E\\u0440\\u043E)\"})]}),/*#__PURE__*/_jsx(\"div\",{style:glassStyle.divider}),authMethod===\"qr\"&&/*#__PURE__*/_jsxs(\"div\",{style:glassStyle.field,children:[/*#__PURE__*/_jsx(\"p\",{style:_objectSpread(_objectSpread({},glassStyle.helper),{},{marginBottom:12}),children:\"\\u0412\\u0445\\u043E\\u0434 \\u043D\\u0430 \\u0434\\u0440\\u0443\\u0433\\u043E\\u043C \\u0443\\u0441\\u0442\\u0440\\u043E\\u0439\\u0441\\u0442\\u0432\\u0435 \\u043F\\u043E QR. \\u041D\\u0430 \\u0443\\u0436\\u0435 \\u0430\\u0432\\u0442\\u043E\\u0440\\u0438\\u0437\\u043E\\u0432\\u0430\\u043D\\u043D\\u043E\\u043C \\u0443\\u0441\\u0442\\u0440\\u043E\\u0439\\u0441\\u0442\\u0432\\u0435 \\u043E\\u0442\\u043A\\u0440\\u043E\\u0439\\u0442\\u0435 \\u041D\\u0430\\u0441\\u0442\\u0440\\u043E\\u0439\\u043A\\u0438 \\u2192 \\xAB\\u0412\\u043E\\u0439\\u0442\\u0438 \\u043D\\u0430 \\u0434\\u0440\\u0443\\u0433\\u043E\\u043C \\u0443\\u0441\\u0442\\u0440\\u043E\\u0439\\u0441\\u0442\\u0432\\u0435 \\u043F\\u043E QR\\xBB \\u0438 \\u043E\\u0442\\u0441\\u043A\\u0430\\u043D\\u0438\\u0440\\u0443\\u0439\\u0442\\u0435 \\u044D\\u0442\\u043E\\u0442 \\u043A\\u043E\\u0434 \\u043A\\u0430\\u043C\\u0435\\u0440\\u043E\\u0439 \\u043D\\u043E\\u0432\\u043E\\u0433\\u043E \\u0443\\u0441\\u0442\\u0440\\u043E\\u0439\\u0441\\u0442\\u0432\\u0430.\"}),/*#__PURE__*/_jsx(\"div\",{style:{padding:16,background:theme.inputBg,borderRadius:14,display:'inline-block'},children:/*#__PURE__*/_jsx(QRCodeSVG,{value:typeof window!==\"undefined\"?window.location.origin+\"/login\":\"https://get-aist.ru/login\",size:200,level:\"M\"})})]}),authMethod!==\"qr\"&&step===\"request\"&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{style:glassStyle.field,children:[/*#__PURE__*/_jsxs(\"div\",{style:glassStyle.label,children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\u041D\\u043E\\u043C\\u0435\\u0440 \\u0442\\u0435\\u043B\\u0435\\u0444\\u043E\\u043D\\u0430\"}),/*#__PURE__*/_jsx(\"span\",{style:glassStyle.helper,children:\"\\u043D\\u0430\\u043F\\u0440\\u0438\\u043C\\u0435\\u0440, +7 999 123-45-67\"})]}),/*#__PURE__*/_jsx(\"div\",{style:glassStyle.inputRow,children:/*#__PURE__*/_jsx(\"input\",{style:glassStyle.input,inputMode:\"tel\",autoComplete:\"tel\",placeholder:\"+7 999 123-45-67\",value:phoneInput,onChange:e=>setPhoneInput(e.target.value),onKeyDown:e=>{if(e.key===\"Enter\")requestCode();},\"aria-label\":\"\\u041D\\u043E\\u043C\\u0435\\u0440 \\u0442\\u0435\\u043B\\u0435\\u0444\\u043E\\u043D\\u0430\"})})]}),/*#__PURE__*/_jsx(\"div\",{style:glassStyle.buttonsRow,children:/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:requestCode,disabled:!canRequest,style:_objectSpread(_objectSpread({},glassStyle.primaryBtn),!canRequest?glassStyle.disabled:null),children:busy?\"Отправляем…\":cooldown>0?\"\\u041F\\u043E\\u0434\\u043E\\u0436\\u0434\\u0438\\u0442\\u0435 \".concat(cooldown,\"\\u0441\"):\"Получить код\"})}),/*#__PURE__*/_jsxs(\"div\",{style:glassStyle.hintBox,children:[/*#__PURE__*/_jsx(\"b\",{children:\"\\u0412\\u0430\\u0436\\u043D\\u043E:\"}),\" \\u0421\\u043D\\u0430\\u0447\\u0430\\u043B\\u0430 \\u0430\\u043A\\u0442\\u0438\\u0432\\u0438\\u0440\\u0443\\u0439\\u0442\\u0435 \\u0431\\u043E\\u0442\\u0430 \",/*#__PURE__*/_jsx(\"b\",{children:\"@AIST_SMS_BOT\"}),\" \\u0432 Telegram:\",/*#__PURE__*/_jsx(\"br\",{}),\"1. \\u041D\\u0430\\u0439\\u0434\\u0438\\u0442\\u0435 \\u0431\\u043E\\u0442\\u0430 \",/*#__PURE__*/_jsx(\"b\",{children:\"@AIST_SMS_BOT\"}),/*#__PURE__*/_jsx(\"br\",{}),\"2. \\u041D\\u0430\\u0436\\u043C\\u0438\\u0442\\u0435 \",/*#__PURE__*/_jsx(\"b\",{children:\"/start\"}),/*#__PURE__*/_jsx(\"br\",{}),\"3. \\u041E\\u0442\\u043F\\u0440\\u0430\\u0432\\u044C\\u0442\\u0435 \\u043D\\u043E\\u043C\\u0435\\u0440 \\u0442\\u0435\\u043B\\u0435\\u0444\\u043E\\u043D\\u0430 \\u0447\\u0435\\u0440\\u0435\\u0437 \\u043A\\u043D\\u043E\\u043F\\u043A\\u0443\",/*#__PURE__*/_jsx(\"br\",{}),\"4. \\u041F\\u043E\\u0441\\u043B\\u0435 \\u044D\\u0442\\u043E\\u0433\\u043E \\u0432\\u0432\\u0435\\u0434\\u0438\\u0442\\u0435 \\u043D\\u043E\\u043C\\u0435\\u0440 \\u0437\\u0434\\u0435\\u0441\\u044C \\u0438 \\u0437\\u0430\\u043F\\u0440\\u043E\\u0441\\u0438\\u0442\\u0435 \\u043A\\u043E\\u0434\"]})]}),authMethod!==\"qr\"&&step===\"verify\"&&/*#__PURE__*/_jsxs(_Fragment,{children:[debugCode&&/*#__PURE__*/_jsxs(\"div\",{style:_objectSpread(_objectSpread({},glassStyle.field),{},{padding:\"12px 16px\",borderRadius:12,background:\"rgba(0,136,204,0.12)\",marginBottom:8}),children:[/*#__PURE__*/_jsx(\"div\",{style:{fontSize:14,color:theme.textMuted,marginBottom:4},children:\"\\u041A\\u043E\\u0434 \\u0434\\u043B\\u044F \\u0432\\u0445\\u043E\\u0434\\u0430 (\\u0442\\u043E\\u043B\\u044C\\u043A\\u043E \\u0434\\u043B\\u044F \\u0442\\u0435\\u0441\\u0442\\u0430)\"}),/*#__PURE__*/_jsx(\"div\",{style:{fontSize:20,fontWeight:700,letterSpacing:4},children:debugCode})]}),/*#__PURE__*/_jsxs(\"div\",{style:glassStyle.field,children:[/*#__PURE__*/_jsxs(\"div\",{style:glassStyle.label,children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\u041A\\u043E\\u0434 \\u0438\\u0437 Telegram\"}),/*#__PURE__*/_jsxs(\"span\",{style:glassStyle.helper,children:[\"\\u0434\\u043B\\u044F \",formatPhone(phone)]})]}),/*#__PURE__*/_jsxs(\"div\",{style:glassStyle.agreementRow,children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",id:\"agreement\",checked:agreementAccepted,onChange:e=>setAgreementAccepted(e.target.checked),style:{marginTop:4,cursor:\"pointer\"},\"aria-describedby\":\"agreement-text\"}),/*#__PURE__*/_jsxs(\"label\",{id:\"agreement-text\",htmlFor:\"agreement\",style:glassStyle.agreementLabel,children:[\"\\u042F \\u043F\\u0440\\u0438\\u043D\\u0438\\u043C\\u0430\\u044E\",\" \",/*#__PURE__*/_jsx(\"a\",{href:USER_AGREEMENT_URL,target:\"_blank\",rel:\"noopener noreferrer\",style:glassStyle.agreementLink,children:\"\\u043F\\u043E\\u043B\\u044C\\u0437\\u043E\\u0432\\u0430\\u0442\\u0435\\u043B\\u044C\\u0441\\u043A\\u043E\\u0435 \\u0441\\u043E\\u0433\\u043B\\u0430\\u0448\\u0435\\u043D\\u0438\\u0435\"}),\" \",\"\\u0438 \\u0443\\u0441\\u043B\\u043E\\u0432\\u0438\\u044F \\u043E\\u0431\\u0440\\u0430\\u0431\\u043E\\u0442\\u043A\\u0438 \\u043F\\u0435\\u0440\\u0441\\u043E\\u043D\\u0430\\u043B\\u044C\\u043D\\u044B\\u0445 \\u0434\\u0430\\u043D\\u043D\\u044B\\u0445 (\\u0432 \\u0441\\u043E\\u043E\\u0442\\u0432\\u0435\\u0442\\u0441\\u0442\\u0432\\u0438\\u0438 \\u0441 \\u0437\\u0430\\u043A\\u043E\\u043D\\u043E\\u0434\\u0430\\u0442\\u0435\\u043B\\u044C\\u0441\\u0442\\u0432\\u043E\\u043C \\u0420\\u0424).\"]})]}),/*#__PURE__*/_jsx(\"input\",{ref:codeInputRef,style:glassStyle.input,inputMode:\"numeric\",autoComplete:\"one-time-code\",placeholder:\"\\u0412\\u0432\\u0435\\u0434\\u0438\\u0442\\u0435 \\u043A\\u043E\\u0434\",value:code,onChange:onCodeChange,onKeyDown:e=>{if(e.key===\"Enter\")verifyCode();},\"aria-label\":\"\\u041A\\u043E\\u0434 \\u043F\\u043E\\u0434\\u0442\\u0432\\u0435\\u0440\\u0436\\u0434\\u0435\\u043D\\u0438\\u044F\"})]}),/*#__PURE__*/_jsxs(\"div\",{style:glassStyle.buttonsRow,children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:verifyCode,disabled:!canVerify,style:_objectSpread(_objectSpread({},glassStyle.primaryBtn),!canVerify?glassStyle.disabled:null),children:busy?\"Проверяем…\":\"Войти\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>{setStep(\"request\");setPhoneInput(phone);setMessage(\"\");},disabled:busy,style:_objectSpread(_objectSpread({},glassStyle.secondaryBtn),busy?glassStyle.disabled:null),children:\"\\u0418\\u0437\\u043C\\u0435\\u043D\\u0438\\u0442\\u044C \\u043D\\u043E\\u043C\\u0435\\u0440\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:requestCode,disabled:busy||cooldown>0,style:_objectSpread(_objectSpread({},glassStyle.secondaryBtn),busy||cooldown>0?glassStyle.disabled:null),title:cooldown>0?\"\\u041F\\u043E\\u0432\\u0442\\u043E\\u0440\\u0438\\u0442\\u044C \\u043C\\u043E\\u0436\\u043D\\u043E \\u0447\\u0435\\u0440\\u0435\\u0437 \".concat(cooldown,\"\\u0441\"):\"Отправить новый код\",children:cooldown>0?\"\\u041F\\u043E\\u0432\\u0442\\u043E\\u0440\\u0438\\u0442\\u044C \\u0447\\u0435\\u0440\\u0435\\u0437 \".concat(cooldown,\"\\u0441\"):\"Отправить ещё раз\"})]}),/*#__PURE__*/_jsxs(\"div\",{style:glassStyle.footer,children:[/*#__PURE__*/_jsx(\"span\",{style:glassStyle.pill,children:maskedDestination?\"\\u0414\\u043E\\u0441\\u0442\\u0430\\u0432\\u043A\\u0430: \".concat(maskedDestination):\"Доставка: @AIST_SMS_BOT\"}),/*#__PURE__*/_jsx(\"span\",{style:glassStyle.pill,children:remaining==null?ttlSeconds?\"\\u0421\\u0440\\u043E\\u043A: ~\".concat(ttlSeconds,\"\\u0441\"):\"Срок: 5 минут\":remaining>0?\"\\u0418\\u0441\\u0442\\u0435\\u043A\\u0430\\u0435\\u0442 \\u0447\\u0435\\u0440\\u0435\\u0437: \".concat(remaining,\"\\u0441\"):\"Код истёк — запросите новый\"})]})]}),message?/*#__PURE__*/_jsx(\"div\",{style:glassStyle.hintBox,role:\"status\",\"aria-live\":\"polite\",children:message}):null,/*#__PURE__*/_jsx(Link,{to:\"/\",style:glassStyle.backLink,children:\"\\u2190 \\u041D\\u0430 \\u0433\\u043B\\u0430\\u0432\\u043D\\u0443\\u044E\"})]})});}","map":{"version":3,"names":["React","useEffect","useMemo","useRef","useState","Link","QRCodeSVG","useTheme","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","API_BASE_URL","process","env","REACT_APP_API_URL","window","_window$location","location","hostname","USER_AGREEMENT_URL","normalizePhone","input","digitsOnly","String","replace","length","startsWith","substring","isValidPhone","value","normalized","test","formatPhone","postJson","url","body","_json","signal","arguments","undefined","res","fetch","method","headers","JSON","stringify","e","name","msg","message","includes","Error","json","_unused","ok","error","concat","status","statusText","trim","err","payload","Register","theme","isDark","authMethod","setAuthMethod","step","setStep","phoneInput","setPhoneInput","phone","setPhone","code","setCode","agreementAccepted","setAgreementAccepted","busy","setBusy","setMessage","maskedDestination","setMaskedDestination","ttlSeconds","setTtlSeconds","remaining","setRemaining","cooldown","setCooldown","debugCode","setDebugCode","abortRef","codeInputRef","canRequest","canVerify","d","current","abort","t","setInterval","r","clearInterval","c","setTimeout","_codeInputRef$current","_codeInputRef$current2","focus","call","clearTimeout","requestCode","_abortRef$current","_abortRef$current$abo","controller","AbortController","data","errorMsg","masked","devCode","verifyCode","_abortRef$current2","_abortRef$current2$ab","normalizedPhone","retryAfterSeconds","retrySec","Math","max","floor","token","localStorage","setItem","assign","onCodeChange","next","target","slice","glassStyle","page","minHeight","width","display","placeItems","padding","margin","color","text","background","pageBg","backgroundAttachment","overflow","card","borderRadius","cardBg","border","cardBorder","boxShadow","backdropFilter","WebkitBackdropFilter","position","shine","inset","pointerEvents","mixBlendMode","header","gap","alignItems","logo","height","accent","fontWeight","fontSize","accentText","userSelect","titleWrap","flexDirection","title","lineHeight","subtitle","textMuted","tabs","marginBottom","borderBottom","paddingBottom","tab","cursor","tabActive","sidebarBg","tabDisabled","opacity","divider","field","marginTop","label","justifyContent","helper","outline","inputBg","inputBorder","inputRow","gridTemplateColumns","buttonsRow","flexWrap","primaryBtn","flex","secondaryBtn","disabled","hintBox","agreementRow","agreementLabel","agreementLink","textDecoration","marginLeft","footer","pill","backLink","style","children","_objectSpread","role","type","onClick","origin","size","level","inputMode","autoComplete","placeholder","onChange","onKeyDown","key","letterSpacing","id","checked","htmlFor","href","rel","ref","to"],"sources":["C:/Users/Vladislav/Documents/GitHub/aist-messenger/src/pages/Register.jsx"],"sourcesContent":["import React, { useEffect, useMemo, useRef, useState } from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { QRCodeSVG } from \"qrcode.react\";\r\nimport { useTheme } from \"../context/ThemeContext\";\r\n\r\n/**\r\n * AIST PWA Messenger — Register/Login screen\r\n * Вход по коду из Telegram или (в будущем) по СМС. При входе по коду из ТГ — пользовательское соглашение (законы РФ).\r\n */\r\n\r\nconst API_BASE_URL = process.env.REACT_APP_API_URL || (typeof window !== \"undefined\" && window.location?.hostname === \"localhost\" ? \"http://localhost:3001\" : \"https://api.get-aist.ru\");\r\n\r\nconst USER_AGREEMENT_URL = \"/user-agreement\";\r\n\r\nfunction normalizePhone(input) {\r\n  if (!input) return \"\";\r\n  const digitsOnly = String(input).replace(/\\D/g, \"\");\r\n  \r\n  if (digitsOnly.length === 11 && digitsOnly.startsWith(\"7\")) {\r\n    return \"+\" + digitsOnly;\r\n  } else if (digitsOnly.length === 10) {\r\n    return \"+7\" + digitsOnly;\r\n  } else if (digitsOnly.length === 11 && digitsOnly.startsWith(\"8\")) {\r\n    return \"+7\" + digitsOnly.substring(1);\r\n  }\r\n  return \"\";\r\n}\r\n\r\nfunction isValidPhone(value) {\r\n  const normalized = normalizePhone(value);\r\n  if (!normalized) return false;\r\n  return /^\\+7\\d{10}$/.test(normalized);\r\n}\r\n\r\nfunction formatPhone(value) {\r\n  const normalized = normalizePhone(value);\r\n  if (!normalized) return value;\r\n  return normalized.replace(/^(\\+7)(\\d{3})(\\d{3})(\\d{2})(\\d{2})$/, \"$1 ($2) $3-$4-$5\");\r\n}\r\n\r\nfunction digitsOnly(value) {\r\n  return String(value ?? \"\").replace(/\\D+/g, \"\");\r\n}\r\n\r\nasync function postJson(url, body, { signal } = {}) {\r\n  let res;\r\n  try {\r\n    res = await fetch(url, {\r\n      method: \"POST\",\r\n      headers: { \"Content-Type\": \"application/json\" },\r\n      body: JSON.stringify(body ?? {}),\r\n      signal,\r\n    });\r\n  } catch (e) {\r\n    if (e.name === \"AbortError\") throw e;\r\n    const msg = e.message || \"\";\r\n    if (msg.includes(\"Failed to fetch\") || msg.includes(\"Load failed\") || msg.includes(\"NetworkError\")) {\r\n      throw new Error(\"Нет связи с сервером. Проверьте интернет и что бэкенд запущен (например http://localhost:3001). В .env задайте REACT_APP_API_URL.\");\r\n    }\r\n    throw new Error(msg || \"Ошибка сети\");\r\n  }\r\n\r\n  let json = null;\r\n  try {\r\n    json = await res.json();\r\n  } catch {\r\n    // ignore\r\n  }\r\n\r\n  if (!res.ok) {\r\n    const message =\r\n      (json && (json.message || json.error)) ||\r\n      `HTTP ${res.status} ${res.statusText}`.trim();\r\n    const err = new Error(message);\r\n    err.status = res.status;\r\n    err.payload = json;\r\n    throw err;\r\n  }\r\n\r\n  return json ?? {};\r\n}\r\n\r\nexport default function Register() {\r\n  const { theme, isDark } = useTheme();\r\n  const [authMethod, setAuthMethod] = useState(\"telegram\"); // 'telegram' | 'sms' (sms пока заглушка)\r\n  const [step, setStep] = useState(\"request\");\r\n  const [phoneInput, setPhoneInput] = useState(\"\");\r\n  const [phone, setPhone] = useState(\"\");\r\n  const [code, setCode] = useState(\"\");\r\n  const [agreementAccepted, setAgreementAccepted] = useState(false);\r\n  const [busy, setBusy] = useState(false);\r\n  const [message, setMessage] = useState(\"\");\r\n  const [maskedDestination, setMaskedDestination] = useState(\"\");\r\n  const [ttlSeconds, setTtlSeconds] = useState(null);\r\n  const [remaining, setRemaining] = useState(null);\r\n  const [cooldown, setCooldown] = useState(0);\r\n  const [debugCode, setDebugCode] = useState(\"\"); // если бэкенд вернул debugCode — показываем для теста\r\n\r\n  const abortRef = useRef(null);\r\n  const codeInputRef = useRef(null);\r\n\r\n  const canRequest = useMemo(() => {\r\n    if (busy) return false;\r\n    if (cooldown > 0) return false;\r\n    return isValidPhone(phoneInput);\r\n  }, [busy, cooldown, phoneInput]);\r\n\r\n  const canVerify = useMemo(() => {\r\n    if (busy) return false;\r\n    if (!agreementAccepted) return false;\r\n    const d = digitsOnly(code);\r\n    return d.length >= 4 && d.length <= 8;\r\n  }, [busy, agreementAccepted, code]);\r\n\r\n  useEffect(() => {\r\n    return () => {\r\n      if (abortRef.current) abortRef.current.abort();\r\n    };\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (remaining == null) return;\r\n    if (remaining <= 0) return;\r\n    const t = setInterval(() => setRemaining((r) => (r == null ? r : r - 1)), 1000);\r\n    return () => clearInterval(t);\r\n  }, [remaining]);\r\n\r\n  useEffect(() => {\r\n    if (cooldown <= 0) return;\r\n    const t = setInterval(() => setCooldown((c) => (c <= 0 ? 0 : c - 1)), 1000);\r\n    return () => clearInterval(t);\r\n  }, [cooldown]);\r\n\r\n  useEffect(() => {\r\n    if (step !== \"verify\") return;\r\n    const t = setTimeout(() => codeInputRef.current?.focus?.(), 50);\r\n    return () => clearTimeout(t);\r\n  }, [step]);\r\n\r\n  async function requestCode() {\r\n    setMessage(\"\");\r\n    const normalized = normalizePhone(phoneInput);\r\n    if (!isValidPhone(normalized)) {\r\n      setMessage(\"Введите корректный номер телефона (например, +7 999 123-45-67 или 8 999 123-45-67).\");\r\n      return;\r\n    }\r\n\r\n    setBusy(true);\r\n    abortRef.current?.abort?.();\r\n    const controller = new AbortController();\r\n    abortRef.current = controller;\r\n\r\n    try {\r\n      const data = await postJson(\r\n        `${API_BASE_URL}/api/auth/request-code`,\r\n        { phone: normalized },\r\n        { signal: controller.signal }\r\n      );\r\n\r\n      if (data?.ok === false) {\r\n        const errorMsg = data?.message || \"Не удалось отправить код. Попробуйте ещё раз.\";\r\n        setMessage(errorMsg);\r\n        if (errorMsg.includes(\"не найден\") || errorMsg.includes(\"активируйте\")) {\r\n          setMessage(errorMsg + \" После активации попробуйте снова.\");\r\n        }\r\n        return;\r\n      }\r\n\r\n      setPhone(normalized);\r\n      setMaskedDestination(data?.masked || \"\");\r\n      setTtlSeconds(typeof data?.ttlSeconds === \"number\" ? data.ttlSeconds : 300);\r\n      setRemaining(typeof data?.ttlSeconds === \"number\" ? data.ttlSeconds : 300);\r\n      setCooldown(15);\r\n      const devCode = data?.debugCode != null ? String(data.debugCode) : \"\";\r\n      setDebugCode(devCode);\r\n      setCode(devCode);\r\n      setAgreementAccepted(false);\r\n      setStep(\"verify\");\r\n      if (devCode) {\r\n        setMessage(\"Код для входа (режим разработки): введите его ниже или скопируйте.\");\r\n      } else {\r\n        setMessage(\r\n          data?.masked\r\n            ? `Код отправлен в Telegram на номер ${data.masked}.`\r\n            : \"Код отправлен в Telegram-бот @AIST_SMS_BOT. Введите его здесь.\"\r\n        );\r\n      }\r\n    } catch (err) {\r\n      if (err?.name === \"AbortError\") return;\r\n      setMessage(err?.message || \"Ошибка сети при отправке кода. Проверьте REACT_APP_API_URL и что бэкенд запущен.\");\r\n    } finally {\r\n      setBusy(false);\r\n    }\r\n  }\r\n\r\n  async function verifyCode() {\r\n    setMessage(\"\");\r\n    const normalizedPhone = normalizePhone(phone);\r\n    const d = digitsOnly(code);\r\n    if (!normalizedPhone) {\r\n      setStep(\"request\");\r\n      setMessage(\"Сначала укажите номер телефона и запросите код.\");\r\n      return;\r\n    }\r\n    if (d.length < 4 || d.length > 8) {\r\n      setMessage(\"Введите код из 4–8 цифр.\");\r\n      return;\r\n    }\r\n    if (!agreementAccepted) {\r\n      setMessage(\"Необходимо принять пользовательское соглашение.\");\r\n      return;\r\n    }\r\n\r\n    setBusy(true);\r\n    abortRef.current?.abort?.();\r\n    const controller = new AbortController();\r\n    abortRef.current = controller;\r\n\r\n    try {\r\n      const data = await postJson(\r\n        `${API_BASE_URL}/api/auth/verify-code`,\r\n        { phone: normalizedPhone, code: d },\r\n        { signal: controller.signal }\r\n      );\r\n\r\n      if (data?.ok === false) {\r\n        const errorMsg = data?.message || \"Неверный код или он истёк. Попробуйте ещё раз.\";\r\n        if (typeof data?.retryAfterSeconds === \"number\") {\r\n          const retrySec = Math.max(0, Math.floor(data.retryAfterSeconds));\r\n          setCooldown(retrySec);\r\n          setMessage(`${errorMsg} Повторить можно через ${retrySec} секунд.`);\r\n        } else {\r\n          setMessage(errorMsg);\r\n        }\r\n        return;\r\n      }\r\n\r\n      const token = data?.token;\r\n      if (token) {\r\n        localStorage.setItem(\"aist_token\", token);\r\n      }\r\n\r\n      window.location.assign(\"/messenger\");\r\n    } catch (err) {\r\n      if (err?.name === \"AbortError\") return;\r\n      setMessage(err?.message || \"Ошибка сети при проверке кода.\");\r\n    } finally {\r\n      setBusy(false);\r\n    }\r\n  }\r\n\r\n  function onCodeChange(e) {\r\n    const next = digitsOnly(e.target.value).slice(0, 8);\r\n    setCode(next);\r\n  }\r\n\r\n  const glassStyle = useMemo(\r\n    () => ({\r\n      page: {\r\n        minHeight: \"100vh\",\r\n        width: \"100vw\",\r\n        display: \"grid\",\r\n        placeItems: \"center\",\r\n        padding: \"20px 0\",\r\n        margin: 0,\r\n        color: theme.text,\r\n        background: theme.pageBg,\r\n        backgroundAttachment: \"fixed\",\r\n        overflow: \"auto\",\r\n      },\r\n      card: {\r\n        width: \"min(460px, 92vw)\",\r\n        borderRadius: 22,\r\n        padding: 22,\r\n        background: theme.cardBg,\r\n        border: `1px solid ${theme.cardBorder}`,\r\n        boxShadow: isDark\r\n          ? \"0 18px 60px rgba(0,0,0,.4), inset 0 1px 0 rgba(255,255,255,.08)\"\r\n          : \"0 20px 60px rgba(80,120,180,.18), inset 0 1px 0 rgba(255,255,255,.7)\",\r\n        backdropFilter: \"blur(16px) saturate(140%)\",\r\n        WebkitBackdropFilter: \"blur(16px) saturate(140%)\",\r\n        position: \"relative\",\r\n        overflow: \"hidden\",\r\n      },\r\n      shine: {\r\n        position: \"absolute\",\r\n        inset: \"-2px\",\r\n        background: isDark\r\n          ? \"radial-gradient(500px 240px at 20% 10%, rgba(255,255,255,.12), transparent 60%)\"\r\n          : \"radial-gradient(400px 200px at 80% 0%, rgba(255,255,255,.4), transparent 55%)\",\r\n        pointerEvents: \"none\",\r\n        mixBlendMode: \"overlay\",\r\n      },\r\n      header: { display: \"flex\", gap: 12, alignItems: \"center\" },\r\n      logo: {\r\n        width: 44,\r\n        height: 44,\r\n        borderRadius: 14,\r\n        background: theme.accent,\r\n        border: \"1px solid rgba(255,255,255,.35)\",\r\n        boxShadow: \"0 8px 24px rgba(0,0,0,.2)\",\r\n        display: \"grid\",\r\n        placeItems: \"center\",\r\n        fontWeight: 800,\r\n        fontSize: 16,\r\n        color: theme.accentText,\r\n        userSelect: \"none\",\r\n      },\r\n      titleWrap: { display: \"flex\", flexDirection: \"column\" },\r\n      title: { margin: 0, fontSize: 18, fontWeight: 700, lineHeight: 1.15, color: theme.text },\r\n      subtitle: { margin: \"6px 0 0\", fontSize: 13, color: theme.textMuted, lineHeight: 1.25 },\r\n      tabs: {\r\n        display: \"flex\",\r\n        gap: 8,\r\n        marginBottom: 16,\r\n        borderBottom: `1px solid ${theme.border}`,\r\n        paddingBottom: 12,\r\n      },\r\n      tab: {\r\n        padding: \"8px 14px\",\r\n        borderRadius: 12,\r\n        border: \"none\",\r\n        background: \"transparent\",\r\n        color: theme.textMuted,\r\n        fontSize: 14,\r\n        cursor: \"pointer\",\r\n      },\r\n      tabActive: { color: theme.text, background: theme.sidebarBg || theme.cardBg, fontWeight: 600 },\r\n      tabDisabled: { opacity: 0.5, cursor: \"not-allowed\" },\r\n      divider: {\r\n        height: 1,\r\n        background: `linear-gradient(90deg, transparent, ${theme.border}, transparent)`,\r\n        margin: \"16px 0\",\r\n      },\r\n      field: { display: \"grid\", gap: 8, marginTop: 12 },\r\n      label: { fontSize: 12, color: theme.textMuted, display: \"flex\", justifyContent: \"space-between\", gap: 12 },\r\n      helper: { fontSize: 12, color: theme.textMuted, opacity: 0.9 },\r\n      input: {\r\n        width: \"100%\",\r\n        padding: \"12px 14px\",\r\n        borderRadius: 14,\r\n        outline: \"none\",\r\n        color: theme.text,\r\n        background: theme.inputBg,\r\n        border: `1px solid ${theme.inputBorder}`,\r\n        fontSize: 14,\r\n      },\r\n      inputRow: { display: \"grid\", gridTemplateColumns: \"1fr\", gap: 10 },\r\n      buttonsRow: { display: \"flex\", gap: 10, marginTop: 14, flexWrap: \"wrap\" },\r\n      primaryBtn: {\r\n        flex: \"1 1 160px\",\r\n        padding: \"12px 14px\",\r\n        borderRadius: 14,\r\n        border: \"1px solid rgba(255,255,255,.25)\",\r\n        color: theme.accentText,\r\n        background: theme.accent,\r\n        boxShadow: \"0 10px 30px rgba(0,0,0,.2)\",\r\n        fontWeight: 600,\r\n        cursor: \"pointer\",\r\n      },\r\n      secondaryBtn: {\r\n        flex: \"1 1 160px\",\r\n        padding: \"12px 14px\",\r\n        borderRadius: 14,\r\n        border: `1px solid ${theme.border}`,\r\n        color: theme.text,\r\n        background: theme.sidebarBg || \"rgba(255,255,255,.08)\",\r\n        cursor: \"pointer\",\r\n        fontSize: 14,\r\n      },\r\n      disabled: { opacity: 0.55, cursor: \"not-allowed\" },\r\n      hintBox: {\r\n        marginTop: 12,\r\n        padding: \"10px 12px\",\r\n        borderRadius: 14,\r\n        background: theme.sidebarBg || \"rgba(255,255,255,.06)\",\r\n        border: `1px solid ${theme.border}`,\r\n        color: theme.textMuted,\r\n        fontSize: 13,\r\n        lineHeight: 1.35,\r\n      },\r\n      agreementRow: {\r\n        display: \"flex\",\r\n        alignItems: \"flex-start\",\r\n        gap: 10,\r\n        marginTop: 12,\r\n        marginBottom: 8,\r\n      },\r\n      agreementLabel: { fontSize: 13, color: theme.textMuted, lineHeight: 1.4, cursor: \"pointer\" },\r\n      agreementLink: { color: theme.text, textDecoration: \"underline\", marginLeft: 2 },\r\n      footer: {\r\n        marginTop: 14,\r\n        display: \"flex\",\r\n        justifyContent: \"space-between\",\r\n        gap: 12,\r\n        color: theme.textMuted,\r\n        fontSize: 12,\r\n        flexWrap: \"wrap\",\r\n      },\r\n      pill: {\r\n        padding: \"6px 10px\",\r\n        borderRadius: 999,\r\n        border: `1px solid ${theme.border}`,\r\n        background: theme.sidebarBg || \"rgba(255,255,255,.06)\",\r\n      },\r\n      backLink: { color: theme.textMuted, fontSize: 14, marginTop: 16, display: \"block\" },\r\n    }),\r\n    [theme, isDark]\r\n  );\r\n\r\n  return (\r\n    <div style={glassStyle.page}>\r\n      <div style={{ ...glassStyle.card, margin: \"20px\" }} role=\"region\" aria-label=\"AIST вход\">\r\n        <div style={glassStyle.shine} />\r\n\r\n        <div style={glassStyle.header}>\r\n          <div style={glassStyle.logo} aria-hidden=\"true\">\r\n            AI\r\n          </div>\r\n          <div style={glassStyle.titleWrap}>\r\n            <h1 style={glassStyle.title}>AIST</h1>\r\n            <p style={glassStyle.subtitle}>\r\n              Вход по коду из Telegram-бота @AIST_SMS_BOT\r\n            </p>\r\n          </div>\r\n        </div>\r\n\r\n        <div style={glassStyle.tabs}>\r\n          <button\r\n            type=\"button\"\r\n            style={{\r\n              ...glassStyle.tab,\r\n              ...(authMethod === \"telegram\" ? glassStyle.tabActive : {}),\r\n            }}\r\n            onClick={() => setAuthMethod(\"telegram\")}\r\n          >\r\n            По коду из Telegram\r\n          </button>\r\n          <button\r\n            type=\"button\"\r\n            style={{\r\n              ...glassStyle.tab,\r\n              ...(authMethod === \"qr\" ? glassStyle.tabActive : {}),\r\n            }}\r\n            onClick={() => setAuthMethod(\"qr\")}\r\n          >\r\n            По QR\r\n          </button>\r\n          <button\r\n            type=\"button\"\r\n            style={{ ...glassStyle.tab, ...glassStyle.tabDisabled }}\r\n            disabled\r\n            title=\"Скоро\"\r\n          >\r\n            По СМС (скоро)\r\n          </button>\r\n        </div>\r\n        <div style={glassStyle.divider} />\r\n\r\n        {authMethod === \"qr\" && (\r\n          <div style={glassStyle.field}>\r\n            <p style={{ ...glassStyle.helper, marginBottom: 12 }}>\r\n              Вход на другом устройстве по QR. На уже авторизованном устройстве откройте Настройки → «Войти на другом устройстве по QR» и отсканируйте этот код камерой нового устройства.\r\n            </p>\r\n            <div style={{ padding: 16, background: theme.inputBg, borderRadius: 14, display: 'inline-block' }}>\r\n              <QRCodeSVG\r\n                value={typeof window !== \"undefined\" ? window.location.origin + \"/login\" : \"https://get-aist.ru/login\"}\r\n                size={200}\r\n                level=\"M\"\r\n              />\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {authMethod !== \"qr\" && step === \"request\" && (\r\n          <>\r\n            <div style={glassStyle.field}>\r\n              <div style={glassStyle.label}>\r\n                <span>Номер телефона</span>\r\n                <span style={glassStyle.helper}>например, +7 999 123-45-67</span>\r\n              </div>\r\n              <div style={glassStyle.inputRow}>\r\n                <input\r\n                  style={glassStyle.input}\r\n                  inputMode=\"tel\"\r\n                  autoComplete=\"tel\"\r\n                  placeholder=\"+7 999 123-45-67\"\r\n                  value={phoneInput}\r\n                  onChange={(e) => setPhoneInput(e.target.value)}\r\n                  onKeyDown={(e) => {\r\n                    if (e.key === \"Enter\") requestCode();\r\n                  }}\r\n                  aria-label=\"Номер телефона\"\r\n                />\r\n              </div>\r\n            </div>\r\n\r\n            <div style={glassStyle.buttonsRow}>\r\n              <button\r\n                type=\"button\"\r\n                onClick={requestCode}\r\n                disabled={!canRequest}\r\n                style={{\r\n                  ...glassStyle.primaryBtn,\r\n                  ...(!canRequest ? glassStyle.disabled : null),\r\n                }}\r\n              >\r\n                {busy ? \"Отправляем…\" : cooldown > 0 ? `Подождите ${cooldown}с` : \"Получить код\"}\r\n              </button>\r\n            </div>\r\n\r\n            <div style={glassStyle.hintBox}>\r\n              <b>Важно:</b> Сначала активируйте бота <b>@AIST_SMS_BOT</b> в Telegram:\r\n              <br />1. Найдите бота <b>@AIST_SMS_BOT</b>\r\n              <br />2. Нажмите <b>/start</b>\r\n              <br />3. Отправьте номер телефона через кнопку\r\n              <br />4. После этого введите номер здесь и запросите код\r\n            </div>\r\n          </>\r\n        )}\r\n\r\n        {authMethod !== \"qr\" && step === \"verify\" && (\r\n          <>\r\n            {debugCode && (\r\n              <div style={{ ...glassStyle.field, padding: \"12px 16px\", borderRadius: 12, background: \"rgba(0,136,204,0.12)\", marginBottom: 8 }}>\r\n                <div style={{ fontSize: 14, color: theme.textMuted, marginBottom: 4 }}>Код для входа (только для теста)</div>\r\n                <div style={{ fontSize: 20, fontWeight: 700, letterSpacing: 4 }}>{debugCode}</div>\r\n              </div>\r\n            )}\r\n            <div style={glassStyle.field}>\r\n              <div style={glassStyle.label}>\r\n                <span>Код из Telegram</span>\r\n                <span style={glassStyle.helper}>для {formatPhone(phone)}</span>\r\n              </div>\r\n              <div style={glassStyle.agreementRow}>\r\n                <input\r\n                  type=\"checkbox\"\r\n                  id=\"agreement\"\r\n                  checked={agreementAccepted}\r\n                  onChange={(e) => setAgreementAccepted(e.target.checked)}\r\n                  style={{ marginTop: 4, cursor: \"pointer\" }}\r\n                  aria-describedby=\"agreement-text\"\r\n                />\r\n                <label id=\"agreement-text\" htmlFor=\"agreement\" style={glassStyle.agreementLabel}>\r\n                  Я принимаю{\" \"}\r\n                  <a href={USER_AGREEMENT_URL} target=\"_blank\" rel=\"noopener noreferrer\" style={glassStyle.agreementLink}>\r\n                    пользовательское соглашение\r\n                  </a>{\" \"}\r\n                  и условия обработки персональных данных (в соответствии с законодательством РФ).\r\n                </label>\r\n              </div>\r\n              <input\r\n                ref={codeInputRef}\r\n                style={glassStyle.input}\r\n                inputMode=\"numeric\"\r\n                autoComplete=\"one-time-code\"\r\n                placeholder=\"Введите код\"\r\n                value={code}\r\n                onChange={onCodeChange}\r\n                onKeyDown={(e) => {\r\n                  if (e.key === \"Enter\") verifyCode();\r\n                }}\r\n                aria-label=\"Код подтверждения\"\r\n              />\r\n            </div>\r\n\r\n            <div style={glassStyle.buttonsRow}>\r\n              <button\r\n                type=\"button\"\r\n                onClick={verifyCode}\r\n                disabled={!canVerify}\r\n                style={{\r\n                  ...glassStyle.primaryBtn,\r\n                  ...(!canVerify ? glassStyle.disabled : null),\r\n                }}\r\n              >\r\n                {busy ? \"Проверяем…\" : \"Войти\"}\r\n              </button>\r\n\r\n              <button\r\n                type=\"button\"\r\n                onClick={() => {\r\n                  setStep(\"request\");\r\n                  setPhoneInput(phone);\r\n                  setMessage(\"\");\r\n                }}\r\n                disabled={busy}\r\n                style={{\r\n                  ...glassStyle.secondaryBtn,\r\n                  ...(busy ? glassStyle.disabled : null),\r\n                }}\r\n              >\r\n                Изменить номер\r\n              </button>\r\n\r\n              <button\r\n                type=\"button\"\r\n                onClick={requestCode}\r\n                disabled={busy || cooldown > 0}\r\n                style={{\r\n                  ...glassStyle.secondaryBtn,\r\n                  ...(busy || cooldown > 0 ? glassStyle.disabled : null),\r\n                }}\r\n                title={cooldown > 0 ? `Повторить можно через ${cooldown}с` : \"Отправить новый код\"}\r\n              >\r\n                {cooldown > 0 ? `Повторить через ${cooldown}с` : \"Отправить ещё раз\"}\r\n              </button>\r\n            </div>\r\n\r\n            <div style={glassStyle.footer}>\r\n              <span style={glassStyle.pill}>\r\n                {maskedDestination\r\n                  ? `Доставка: ${maskedDestination}`\r\n                  : \"Доставка: @AIST_SMS_BOT\"}\r\n              </span>\r\n              <span style={glassStyle.pill}>\r\n                {remaining == null\r\n                  ? ttlSeconds\r\n                    ? `Срок: ~${ttlSeconds}с`\r\n                    : \"Срок: 5 минут\"\r\n                  : remaining > 0\r\n                    ? `Истекает через: ${remaining}с`\r\n                    : \"Код истёк — запросите новый\"}\r\n              </span>\r\n            </div>\r\n          </>\r\n        )}\r\n\r\n        {message ? (\r\n          <div style={glassStyle.hintBox} role=\"status\" aria-live=\"polite\">\r\n            {message}\r\n          </div>\r\n        ) : null}\r\n        <Link to=\"/\" style={glassStyle.backLink}>\r\n          ← На главную\r\n        </Link>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}