{"ast":null,"code":"/**\r\n * Папки чатов (как в Telegram). Хранение в localStorage.\r\n */\n\nconst KEY = 'aist_chat_folders';\nexport function getFolders() {\n  try {\n    const raw = localStorage.getItem(KEY);\n    const list = raw ? JSON.parse(raw) : [];\n    return Array.isArray(list) ? list : [];\n  } catch {\n    return [];\n  }\n}\nexport function saveFolders(folders) {\n  try {\n    localStorage.setItem(KEY, JSON.stringify(folders));\n  } catch {}\n}\nexport function addFolder(name) {\n  const folders = getFolders();\n  const id = `folder_${Date.now()}_${Math.random().toString(36).slice(2, 9)}`;\n  folders.push({\n    id,\n    name: (name || '').trim() || 'Новая папка',\n    chatIds: []\n  });\n  saveFolders(folders);\n  return id;\n}\nexport function updateFolder(id, {\n  name,\n  chatIds\n}) {\n  const folders = getFolders();\n  const idx = folders.findIndex(f => f.id === id);\n  if (idx < 0) return;\n  if (name !== undefined) folders[idx].name = String(name).trim() || folders[idx].name;\n  if (chatIds !== undefined) folders[idx].chatIds = Array.isArray(chatIds) ? chatIds : folders[idx].chatIds;\n  saveFolders(folders);\n}\nexport function deleteFolder(id) {\n  const folders = getFolders().filter(f => f.id !== id);\n  saveFolders(folders);\n}\nexport function addChatToFolder(folderId, chatId) {\n  const folders = getFolders();\n  const folder = folders.find(f => f.id === folderId);\n  if (!folder || folder.chatIds.includes(chatId)) return;\n  folder.chatIds.push(chatId);\n  saveFolders(folders);\n}\nexport function removeChatFromFolder(folderId, chatId) {\n  const folders = getFolders();\n  const folder = folders.find(f => f.id === folderId);\n  if (!folder) return;\n  folder.chatIds = folder.chatIds.filter(id => id !== chatId);\n  saveFolders(folders);\n}\nexport function getChatFolderIds(chatId) {\n  return getFolders().filter(f => f.chatIds && f.chatIds.includes(chatId)).map(f => f.id);\n}","map":{"version":3,"names":["KEY","getFolders","raw","localStorage","getItem","list","JSON","parse","Array","isArray","saveFolders","folders","setItem","stringify","addFolder","name","id","Date","now","Math","random","toString","slice","push","trim","chatIds","updateFolder","idx","findIndex","f","undefined","String","deleteFolder","filter","addChatToFolder","folderId","chatId","folder","find","includes","removeChatFromFolder","getChatFolderIds","map"],"sources":["C:/Users/Vladislav/Documents/GitHub/aist-messenger/src/lib/folderStorage.js"],"sourcesContent":["/**\r\n * Папки чатов (как в Telegram). Хранение в localStorage.\r\n */\r\n\r\nconst KEY = 'aist_chat_folders';\r\n\r\nexport function getFolders() {\r\n  try {\r\n    const raw = localStorage.getItem(KEY);\r\n    const list = raw ? JSON.parse(raw) : [];\r\n    return Array.isArray(list) ? list : [];\r\n  } catch {\r\n    return [];\r\n  }\r\n}\r\n\r\nexport function saveFolders(folders) {\r\n  try {\r\n    localStorage.setItem(KEY, JSON.stringify(folders));\r\n  } catch {}\r\n}\r\n\r\nexport function addFolder(name) {\r\n  const folders = getFolders();\r\n  const id = `folder_${Date.now()}_${Math.random().toString(36).slice(2, 9)}`;\r\n  folders.push({ id, name: (name || '').trim() || 'Новая папка', chatIds: [] });\r\n  saveFolders(folders);\r\n  return id;\r\n}\r\n\r\nexport function updateFolder(id, { name, chatIds }) {\r\n  const folders = getFolders();\r\n  const idx = folders.findIndex((f) => f.id === id);\r\n  if (idx < 0) return;\r\n  if (name !== undefined) folders[idx].name = String(name).trim() || folders[idx].name;\r\n  if (chatIds !== undefined) folders[idx].chatIds = Array.isArray(chatIds) ? chatIds : folders[idx].chatIds;\r\n  saveFolders(folders);\r\n}\r\n\r\nexport function deleteFolder(id) {\r\n  const folders = getFolders().filter((f) => f.id !== id);\r\n  saveFolders(folders);\r\n}\r\n\r\nexport function addChatToFolder(folderId, chatId) {\r\n  const folders = getFolders();\r\n  const folder = folders.find((f) => f.id === folderId);\r\n  if (!folder || folder.chatIds.includes(chatId)) return;\r\n  folder.chatIds.push(chatId);\r\n  saveFolders(folders);\r\n}\r\n\r\nexport function removeChatFromFolder(folderId, chatId) {\r\n  const folders = getFolders();\r\n  const folder = folders.find((f) => f.id === folderId);\r\n  if (!folder) return;\r\n  folder.chatIds = folder.chatIds.filter((id) => id !== chatId);\r\n  saveFolders(folders);\r\n}\r\n\r\nexport function getChatFolderIds(chatId) {\r\n  return getFolders().filter((f) => f.chatIds && f.chatIds.includes(chatId)).map((f) => f.id);\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}